{"version":3,"sources":["es6-promise.js","stackframe.js","exceptionless.min.js","node_modules/stackframe/dist/stackframe.min.js","stack-generator.js","stacktrace-gps.js","node_modules/error-stack-parser/dist/error-stack-parser.min.js","/source/Exceptionless.ts"],"names":["lib$es6$promise$utils$$objectOrFunction","x","lib$es6$promise$utils$$isFunction","lib$es6$promise$utils$$isMaybeThenable","lib$es6$promise$asap$$asap","callback","arg","lib$es6$promise$asap$$queue","lib$es6$promise$asap$$len","lib$es6$promise$asap$$scheduleFlush","lib$es6$promise$asap$$useNextTick","nextTick","process","version","versions","node","match","Array","isArray","setImmediate","lib$es6$promise$asap$$flush","lib$es6$promise$asap$$useVertxTimer","lib$es6$promise$asap$$vertxNext","lib$es6$promise$asap$$useMutationObserver","iterations","observer","lib$es6$promise$asap$$BrowserMutationObserver","document","createTextNode","observe","characterData","data","lib$es6$promise$asap$$useMessageChannel","channel","MessageChannel","port1","onmessage","port2","postMessage","lib$es6$promise$asap$$useSetTimeout","setTimeout","i","undefined","lib$es6$promise$asap$$attemptVertex","r","require","vertx","runOnLoop","runOnContext","e","lib$es6$promise$$internal$$noop","lib$es6$promise$$internal$$selfFullfillment","TypeError","lib$es6$promise$$internal$$cannotReturnOwn","lib$es6$promise$$internal$$getThen","promise","then","error","lib$es6$promise$$internal$$GET_THEN_ERROR","lib$es6$promise$$internal$$tryThen","value","fulfillmentHandler","rejectionHandler","call","lib$es6$promise$$internal$$handleForeignThenable","thenable","lib$es6$promise$asap$$default","sealed","lib$es6$promise$$internal$$resolve","lib$es6$promise$$internal$$fulfill","reason","lib$es6$promise$$internal$$reject","_label","lib$es6$promise$$internal$$handleOwnThenable","_state","lib$es6$promise$$internal$$FULFILLED","_result","lib$es6$promise$$internal$$REJECTED","lib$es6$promise$$internal$$subscribe","lib$es6$promise$$internal$$handleMaybeThenable","maybeThenable","constructor","lib$es6$promise$$internal$$publishRejection","_onerror","lib$es6$promise$$internal$$publish","lib$es6$promise$$internal$$PENDING","_subscribers","length","parent","child","onFulfillment","onRejection","subscribers","settled","detail","lib$es6$promise$$internal$$invokeCallback","lib$es6$promise$$internal$$ErrorObject","this","lib$es6$promise$$internal$$tryCatch","lib$es6$promise$$internal$$TRY_CATCH_ERROR","succeeded","failed","hasCallback","lib$es6$promise$$internal$$initializePromise","resolver","lib$es6$promise$enumerator$$Enumerator","Constructor","input","enumerator","_instanceConstructor","_validateInput","_input","_remaining","_init","_enumerate","_validationError","lib$es6$promise$promise$all$$all","entries","lib$es6$promise$enumerator$$default","lib$es6$promise$promise$race$$race","lib$es6$promise$utils$$isArray","resolve","lib$es6$promise$promise$resolve$$resolve","object","lib$es6$promise$promise$reject$$reject","lib$es6$promise$promise$$needsResolver","lib$es6$promise$promise$$needsNew","lib$es6$promise$promise$$Promise","_id","lib$es6$promise$promise$$counter","lib$es6$promise$polyfill$$polyfill","local","global","self","Function","Error","P","Promise","Object","prototype","toString","cast","lib$es6$promise$promise$$default","lib$es6$promise$utils$$_isArray","lib$es6$promise$asap$$browserWindow","window","lib$es6$promise$asap$$browserGlobal","MutationObserver","WebKitMutationObserver","lib$es6$promise$asap$$isNode","lib$es6$promise$asap$$isWorker","Uint8ClampedArray","importScripts","_eachEntry","entry","c","_settledAt","_willSettleAt","state","lib$es6$promise$promise$all$$default","lib$es6$promise$promise$race$$default","lib$es6$promise$promise$resolve$$default","lib$es6$promise$promise$reject$$default","all","race","reject","result","arguments","catch","lib$es6$promise$polyfill$$default","lib$es6$promise$umd$$ES6Promise","polyfill","define","module","root","factory","amd","exports","StackFrame","_isNumber","n","isNaN","parseFloat","isFinite","functionName","args","fileName","lineNumber","columnNumber","setFunctionName","setArgs","setFileName","setLineNumber","setColumnNumber","getFunctionName","v","String","getArgs","getFileName","getLineNumber","Number","getColumnNumber","join","ErrorStackParser","FIREFOX_SAFARI_STACK_REGEXP","CHROME_IE_STACK_REGEXP","parse","stacktrace","parseOpera","stack","parseV8OrIE","parseFFOrSafari","extractLocation","urlLike","locationParts","split","lastNumber","pop","possibleNumber","slice","map","line","tokens","replace","filter","shift","message","indexOf","parseOpera9","parseOpera11","parseOpera10","lineRE","lines","len","exec","push","argsRaw","functionCall","StackGenerator","backtrace","opts","maxStackSize","curr","callee","test","RegExp","$1","caller","StackTraceGPS","SourceMap","ES6Promise","_createXMLHTTPObject","xmlhttp","XMLHttpFactories","XMLHttpRequest","ActiveXObject","_xdr","url","errback","req","open","onerror","onreadystatechange","readyState","status","responseText","send","_findFunctionName","source","m","commentPos","reFunctionDeclaration","reFunctionExpression","reFunctionEvaluation","code","maxLines","Math","min","substr","_ensureSupportedEnvironment","defineProperty","create","_ensureStackFrameIsLegit","stackframe","_findSourceMappingURL","_newLocationInfoFromSourceMap","rawSourceMap","loc","SourceMapConsumer","originalPositionFor","column","name","sourceCache","_get","location","offline","bind","pinpoint","getMappedLocation","findFunctionName","guessedFunctionName","StackTrace","_merge","first","second","target","forEach","obj","prop","hasOwnProperty","_isShapedLikeParsableError","err","_options","get","fromError","generateArtificially","stackframes","sf","resolveOriginal","_","stackFrames","instrument","fn","thisArg","__stacktraceOriginalFn","instrumented","apply","deinstrument","Exceptionless","ContextData","setException","exception","enumerable","configurable","getException","hasException","markAsUnhandledError","setSubmissionMethod","method","getSubmissionMethod","InMemoryLastReferenceIdManager","_lastReferenceId","getLast","clearLast","setLast","eventId","ConsoleLog","info","console","warn","NullLog","EventPluginContext","client","event","contextData","cancel","config","log","EventPluginManager","run","context","plugins","reduce","plugin","addDefaultPlugins","addPlugin","ConfigurationDefaultsPlugin","ErrorPlugin","DuplicateCheckerPlugin","ModuleInfoPlugin","RequestInfoPlugin","EnvironmentInfoPlugin","SubmissionMethodPlugin","ReferenceIdPlugin","priority","reference_id","type","Utils","guid","substring","DefaultEventQueue","_processingQueue","_config","enqueue","ensureQueueTimer","areQueuedItemsDiscarded","key","queuePath","Date","toJSON","randomNumber","storage","save","_this","enabled","apiKey","events","submissionBatchSize","serverUrl","submissionClient","submit","response","processSubmissionResponse","ex","suspendProcessing","success","serviceUnavailable","requeueEvents","paymentRequired","unableToAuthenticate","notFound","badRequest","requestEntityTooLarge","max","round","_queueTimer","setInterval","onProcessQueue","isQueueProcessingSuspended","durationInMinutes","discardFutureQueuedItems","clearQueue","_suspendProcessingUntil","getTime","_discardQueuedItemsUntil","clear","Exception","index","InMemoryStorage","_items","path","searchPattern","limit","results","regex","count","getHashCode","hash","character","charCodeAt","s4","floor","random","merge","defaultValues","values","parseVersion","versionRegex","matches","parseQueryString","query","pairs","pair","decodeURIComponent","stringify","cache","JSON","Configuration","settings","inject","_enabled","_serverUrl","_plugins","lastReferenceIdManager","defaultTags","defaultData","defaults","environmentInfoCollector","errorParser","moduleCollector","requestInfoCollector","queue","_apiKey","set","sort","p1","p2","pluginOrName","pluginAction","pluginExists","removePlugin","splice","setVersion","setUserIdentity","userInfoOrIdentity","userInfo","identity","useReferenceIds","useDebugLogger","_defaultSettings","EventBuilder","pluginContextData","setType","setSource","setSessionId","sessionId","isValidIdentifier","session_id","setReferenceId","referenceId","setMessage","setGeo","latitude","longitude","geo","setProperty","setValue","addTags","tags","_i","markAsCritical","critical","addRequestInfo","request","submitEvent","isDigit","isLetter","isMinus","ExceptionlessClient","settingsOrApiKey","createException","createEvent","submitException","createUnhandledException","submissionMethod","builder","submitUnhandledException","createFeatureUsage","feature","submitFeatureUsage","createLog","sourceOrMessage","level","submitLog","createNotFound","resource","submitNotFound","createSessionStart","submitSessionStart","createSessionEnd","submitSessionEnd","date","getLastReferenceId","_instance","tag","parser","modules","getModules","ri","getRequestInfo","ei","getEnvironmentInfo","SettingsResponse","settingsVersion","SubmissionResponse","statusCode","os","NodeEnvironmentInfoCollector","environmentInfo","processor_count","cpus","total_physical_memory","totalmem","available_physical_memory","freemem","command_line","argv","process_name","title","process_id","pid","process_memory_size","memoryUsage","heapTotal","architecture","arch","o_s_name","o_s_version","release","ip_address","getIpAddresses","machine_name","hostname","runtime_version","loadavg","platform","tmpdir","uptime","endianness","ips","interfaces","networkInterfaces","keys","iface","family","internal","address","nodestacktrace","NodeErrorParser","stack_trace","getStackFrames","frames","frame","getMethodName","file_name","line_number","declaring_type","getTypeName","is_native","isNative","filename","NodeRequestInfoCollector","client_ip_address","ip","user_agent","headers","is_secure","secure","http_method","host","post_data","body","cookies","getCookies","query_string","params","cookie","https","NodeSubmissionClient","sendRequest","msg","getResponseMessage","submitDescription","description","encodeURIComponent","getSettings","statusMessage","parsedHost","options","auth","port","parseInt","Content-Type","Content-Length","on","chunk","write","end","NodeBootstrapper","register","isNode","getExitCodeReason","WebErrorParser","processError","onParseError","parameters","WebModuleCollector","getElementsByTagName","scripts","src","module_id","innerHTML","WebRequestInfoCollector","navigator","requestInfo","userAgent","protocol","pathname","search","referrer","DefaultSubmissionClient","xhr","responseBody","statusText","createRequest","XDomainRequest","setRequestHeader","timeout","ontimeout","onload","WindowBootstrapper","getDefaultsSettingsFromScriptTag","handleWindowOnError","_oldOnErrorHandler","lineno","colno","stackTraceLimit","Infinity"],"mappings":"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","file":"exceptionless.min.js","sourcesContent":["/*!\n * @overview es6-promise - a tiny implementation of Promises/A+.\n * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)\n * @license   Licensed under MIT license\n *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE\n * @version   2.1.1\n */\n\n(function() {\n    \"use strict\";\n    function lib$es6$promise$utils$$objectOrFunction(x) {\n      return typeof x === 'function' || (typeof x === 'object' && x !== null);\n    }\n\n    function lib$es6$promise$utils$$isFunction(x) {\n      return typeof x === 'function';\n    }\n\n    function lib$es6$promise$utils$$isMaybeThenable(x) {\n      return typeof x === 'object' && x !== null;\n    }\n\n    var lib$es6$promise$utils$$_isArray;\n    if (!Array.isArray) {\n      lib$es6$promise$utils$$_isArray = function (x) {\n        return Object.prototype.toString.call(x) === '[object Array]';\n      };\n    } else {\n      lib$es6$promise$utils$$_isArray = Array.isArray;\n    }\n\n    var lib$es6$promise$utils$$isArray = lib$es6$promise$utils$$_isArray;\n    var lib$es6$promise$asap$$len = 0;\n    var lib$es6$promise$asap$$toString = {}.toString;\n    var lib$es6$promise$asap$$vertxNext;\n    function lib$es6$promise$asap$$asap(callback, arg) {\n      lib$es6$promise$asap$$queue[lib$es6$promise$asap$$len] = callback;\n      lib$es6$promise$asap$$queue[lib$es6$promise$asap$$len + 1] = arg;\n      lib$es6$promise$asap$$len += 2;\n      if (lib$es6$promise$asap$$len === 2) {\n        // If len is 2, that means that we need to schedule an async flush.\n        // If additional callbacks are queued before the queue is flushed, they\n        // will be processed by this flush that we are scheduling.\n        lib$es6$promise$asap$$scheduleFlush();\n      }\n    }\n\n    var lib$es6$promise$asap$$default = lib$es6$promise$asap$$asap;\n\n    var lib$es6$promise$asap$$browserWindow = (typeof window !== 'undefined') ? window : undefined;\n    var lib$es6$promise$asap$$browserGlobal = lib$es6$promise$asap$$browserWindow || {};\n    var lib$es6$promise$asap$$BrowserMutationObserver = lib$es6$promise$asap$$browserGlobal.MutationObserver || lib$es6$promise$asap$$browserGlobal.WebKitMutationObserver;\n    var lib$es6$promise$asap$$isNode = typeof process !== 'undefined' && {}.toString.call(process) === '[object process]';\n\n    // test for web worker but not in IE10\n    var lib$es6$promise$asap$$isWorker = typeof Uint8ClampedArray !== 'undefined' &&\n      typeof importScripts !== 'undefined' &&\n      typeof MessageChannel !== 'undefined';\n\n    // node\n    function lib$es6$promise$asap$$useNextTick() {\n      var nextTick = process.nextTick;\n      // node version 0.10.x displays a deprecation warning when nextTick is used recursively\n      // setImmediate should be used instead instead\n      var version = process.versions.node.match(/^(?:(\\d+)\\.)?(?:(\\d+)\\.)?(\\*|\\d+)$/);\n      if (Array.isArray(version) && version[1] === '0' && version[2] === '10') {\n        nextTick = setImmediate;\n      }\n      return function() {\n        nextTick(lib$es6$promise$asap$$flush);\n      };\n    }\n\n    // vertx\n    function lib$es6$promise$asap$$useVertxTimer() {\n      return function() {\n        lib$es6$promise$asap$$vertxNext(lib$es6$promise$asap$$flush);\n      };\n    }\n\n    function lib$es6$promise$asap$$useMutationObserver() {\n      var iterations = 0;\n      var observer = new lib$es6$promise$asap$$BrowserMutationObserver(lib$es6$promise$asap$$flush);\n      var node = document.createTextNode('');\n      observer.observe(node, { characterData: true });\n\n      return function() {\n        node.data = (iterations = ++iterations % 2);\n      };\n    }\n\n    // web worker\n    function lib$es6$promise$asap$$useMessageChannel() {\n      var channel = new MessageChannel();\n      channel.port1.onmessage = lib$es6$promise$asap$$flush;\n      return function () {\n        channel.port2.postMessage(0);\n      };\n    }\n\n    function lib$es6$promise$asap$$useSetTimeout() {\n      return function() {\n        setTimeout(lib$es6$promise$asap$$flush, 1);\n      };\n    }\n\n    var lib$es6$promise$asap$$queue = new Array(1000);\n    function lib$es6$promise$asap$$flush() {\n      for (var i = 0; i < lib$es6$promise$asap$$len; i+=2) {\n        var callback = lib$es6$promise$asap$$queue[i];\n        var arg = lib$es6$promise$asap$$queue[i+1];\n\n        callback(arg);\n\n        lib$es6$promise$asap$$queue[i] = undefined;\n        lib$es6$promise$asap$$queue[i+1] = undefined;\n      }\n\n      lib$es6$promise$asap$$len = 0;\n    }\n\n    function lib$es6$promise$asap$$attemptVertex() {\n      try {\n        var r = require;\n        var vertx = r('vertx');\n        lib$es6$promise$asap$$vertxNext = vertx.runOnLoop || vertx.runOnContext;\n        return lib$es6$promise$asap$$useVertxTimer();\n      } catch(e) {\n        return lib$es6$promise$asap$$useSetTimeout();\n      }\n    }\n\n    var lib$es6$promise$asap$$scheduleFlush;\n    // Decide what async method to use to triggering processing of queued callbacks:\n    if (lib$es6$promise$asap$$isNode) {\n      lib$es6$promise$asap$$scheduleFlush = lib$es6$promise$asap$$useNextTick();\n    } else if (lib$es6$promise$asap$$BrowserMutationObserver) {\n      lib$es6$promise$asap$$scheduleFlush = lib$es6$promise$asap$$useMutationObserver();\n    } else if (lib$es6$promise$asap$$isWorker) {\n      lib$es6$promise$asap$$scheduleFlush = lib$es6$promise$asap$$useMessageChannel();\n    } else if (lib$es6$promise$asap$$browserWindow === undefined && typeof require === 'function') {\n      lib$es6$promise$asap$$scheduleFlush = lib$es6$promise$asap$$attemptVertex();\n    } else {\n      lib$es6$promise$asap$$scheduleFlush = lib$es6$promise$asap$$useSetTimeout();\n    }\n\n    function lib$es6$promise$$internal$$noop() {}\n\n    var lib$es6$promise$$internal$$PENDING   = void 0;\n    var lib$es6$promise$$internal$$FULFILLED = 1;\n    var lib$es6$promise$$internal$$REJECTED  = 2;\n\n    var lib$es6$promise$$internal$$GET_THEN_ERROR = new lib$es6$promise$$internal$$ErrorObject();\n\n    function lib$es6$promise$$internal$$selfFullfillment() {\n      return new TypeError(\"You cannot resolve a promise with itself\");\n    }\n\n    function lib$es6$promise$$internal$$cannotReturnOwn() {\n      return new TypeError('A promises callback cannot return that same promise.');\n    }\n\n    function lib$es6$promise$$internal$$getThen(promise) {\n      try {\n        return promise.then;\n      } catch(error) {\n        lib$es6$promise$$internal$$GET_THEN_ERROR.error = error;\n        return lib$es6$promise$$internal$$GET_THEN_ERROR;\n      }\n    }\n\n    function lib$es6$promise$$internal$$tryThen(then, value, fulfillmentHandler, rejectionHandler) {\n      try {\n        then.call(value, fulfillmentHandler, rejectionHandler);\n      } catch(e) {\n        return e;\n      }\n    }\n\n    function lib$es6$promise$$internal$$handleForeignThenable(promise, thenable, then) {\n       lib$es6$promise$asap$$default(function(promise) {\n        var sealed = false;\n        var error = lib$es6$promise$$internal$$tryThen(then, thenable, function(value) {\n          if (sealed) { return; }\n          sealed = true;\n          if (thenable !== value) {\n            lib$es6$promise$$internal$$resolve(promise, value);\n          } else {\n            lib$es6$promise$$internal$$fulfill(promise, value);\n          }\n        }, function(reason) {\n          if (sealed) { return; }\n          sealed = true;\n\n          lib$es6$promise$$internal$$reject(promise, reason);\n        }, 'Settle: ' + (promise._label || ' unknown promise'));\n\n        if (!sealed && error) {\n          sealed = true;\n          lib$es6$promise$$internal$$reject(promise, error);\n        }\n      }, promise);\n    }\n\n    function lib$es6$promise$$internal$$handleOwnThenable(promise, thenable) {\n      if (thenable._state === lib$es6$promise$$internal$$FULFILLED) {\n        lib$es6$promise$$internal$$fulfill(promise, thenable._result);\n      } else if (thenable._state === lib$es6$promise$$internal$$REJECTED) {\n        lib$es6$promise$$internal$$reject(promise, thenable._result);\n      } else {\n        lib$es6$promise$$internal$$subscribe(thenable, undefined, function(value) {\n          lib$es6$promise$$internal$$resolve(promise, value);\n        }, function(reason) {\n          lib$es6$promise$$internal$$reject(promise, reason);\n        });\n      }\n    }\n\n    function lib$es6$promise$$internal$$handleMaybeThenable(promise, maybeThenable) {\n      if (maybeThenable.constructor === promise.constructor) {\n        lib$es6$promise$$internal$$handleOwnThenable(promise, maybeThenable);\n      } else {\n        var then = lib$es6$promise$$internal$$getThen(maybeThenable);\n\n        if (then === lib$es6$promise$$internal$$GET_THEN_ERROR) {\n          lib$es6$promise$$internal$$reject(promise, lib$es6$promise$$internal$$GET_THEN_ERROR.error);\n        } else if (then === undefined) {\n          lib$es6$promise$$internal$$fulfill(promise, maybeThenable);\n        } else if (lib$es6$promise$utils$$isFunction(then)) {\n          lib$es6$promise$$internal$$handleForeignThenable(promise, maybeThenable, then);\n        } else {\n          lib$es6$promise$$internal$$fulfill(promise, maybeThenable);\n        }\n      }\n    }\n\n    function lib$es6$promise$$internal$$resolve(promise, value) {\n      if (promise === value) {\n        lib$es6$promise$$internal$$reject(promise, lib$es6$promise$$internal$$selfFullfillment());\n      } else if (lib$es6$promise$utils$$objectOrFunction(value)) {\n        lib$es6$promise$$internal$$handleMaybeThenable(promise, value);\n      } else {\n        lib$es6$promise$$internal$$fulfill(promise, value);\n      }\n    }\n\n    function lib$es6$promise$$internal$$publishRejection(promise) {\n      if (promise._onerror) {\n        promise._onerror(promise._result);\n      }\n\n      lib$es6$promise$$internal$$publish(promise);\n    }\n\n    function lib$es6$promise$$internal$$fulfill(promise, value) {\n      if (promise._state !== lib$es6$promise$$internal$$PENDING) { return; }\n\n      promise._result = value;\n      promise._state = lib$es6$promise$$internal$$FULFILLED;\n\n      if (promise._subscribers.length !== 0) {\n        lib$es6$promise$asap$$default(lib$es6$promise$$internal$$publish, promise);\n      }\n    }\n\n    function lib$es6$promise$$internal$$reject(promise, reason) {\n      if (promise._state !== lib$es6$promise$$internal$$PENDING) { return; }\n      promise._state = lib$es6$promise$$internal$$REJECTED;\n      promise._result = reason;\n\n      lib$es6$promise$asap$$default(lib$es6$promise$$internal$$publishRejection, promise);\n    }\n\n    function lib$es6$promise$$internal$$subscribe(parent, child, onFulfillment, onRejection) {\n      var subscribers = parent._subscribers;\n      var length = subscribers.length;\n\n      parent._onerror = null;\n\n      subscribers[length] = child;\n      subscribers[length + lib$es6$promise$$internal$$FULFILLED] = onFulfillment;\n      subscribers[length + lib$es6$promise$$internal$$REJECTED]  = onRejection;\n\n      if (length === 0 && parent._state) {\n        lib$es6$promise$asap$$default(lib$es6$promise$$internal$$publish, parent);\n      }\n    }\n\n    function lib$es6$promise$$internal$$publish(promise) {\n      var subscribers = promise._subscribers;\n      var settled = promise._state;\n\n      if (subscribers.length === 0) { return; }\n\n      var child, callback, detail = promise._result;\n\n      for (var i = 0; i < subscribers.length; i += 3) {\n        child = subscribers[i];\n        callback = subscribers[i + settled];\n\n        if (child) {\n          lib$es6$promise$$internal$$invokeCallback(settled, child, callback, detail);\n        } else {\n          callback(detail);\n        }\n      }\n\n      promise._subscribers.length = 0;\n    }\n\n    function lib$es6$promise$$internal$$ErrorObject() {\n      this.error = null;\n    }\n\n    var lib$es6$promise$$internal$$TRY_CATCH_ERROR = new lib$es6$promise$$internal$$ErrorObject();\n\n    function lib$es6$promise$$internal$$tryCatch(callback, detail) {\n      try {\n        return callback(detail);\n      } catch(e) {\n        lib$es6$promise$$internal$$TRY_CATCH_ERROR.error = e;\n        return lib$es6$promise$$internal$$TRY_CATCH_ERROR;\n      }\n    }\n\n    function lib$es6$promise$$internal$$invokeCallback(settled, promise, callback, detail) {\n      var hasCallback = lib$es6$promise$utils$$isFunction(callback),\n          value, error, succeeded, failed;\n\n      if (hasCallback) {\n        value = lib$es6$promise$$internal$$tryCatch(callback, detail);\n\n        if (value === lib$es6$promise$$internal$$TRY_CATCH_ERROR) {\n          failed = true;\n          error = value.error;\n          value = null;\n        } else {\n          succeeded = true;\n        }\n\n        if (promise === value) {\n          lib$es6$promise$$internal$$reject(promise, lib$es6$promise$$internal$$cannotReturnOwn());\n          return;\n        }\n\n      } else {\n        value = detail;\n        succeeded = true;\n      }\n\n      if (promise._state !== lib$es6$promise$$internal$$PENDING) {\n        // noop\n      } else if (hasCallback && succeeded) {\n        lib$es6$promise$$internal$$resolve(promise, value);\n      } else if (failed) {\n        lib$es6$promise$$internal$$reject(promise, error);\n      } else if (settled === lib$es6$promise$$internal$$FULFILLED) {\n        lib$es6$promise$$internal$$fulfill(promise, value);\n      } else if (settled === lib$es6$promise$$internal$$REJECTED) {\n        lib$es6$promise$$internal$$reject(promise, value);\n      }\n    }\n\n    function lib$es6$promise$$internal$$initializePromise(promise, resolver) {\n      try {\n        resolver(function resolvePromise(value){\n          lib$es6$promise$$internal$$resolve(promise, value);\n        }, function rejectPromise(reason) {\n          lib$es6$promise$$internal$$reject(promise, reason);\n        });\n      } catch(e) {\n        lib$es6$promise$$internal$$reject(promise, e);\n      }\n    }\n\n    function lib$es6$promise$enumerator$$Enumerator(Constructor, input) {\n      var enumerator = this;\n\n      enumerator._instanceConstructor = Constructor;\n      enumerator.promise = new Constructor(lib$es6$promise$$internal$$noop);\n\n      if (enumerator._validateInput(input)) {\n        enumerator._input     = input;\n        enumerator.length     = input.length;\n        enumerator._remaining = input.length;\n\n        enumerator._init();\n\n        if (enumerator.length === 0) {\n          lib$es6$promise$$internal$$fulfill(enumerator.promise, enumerator._result);\n        } else {\n          enumerator.length = enumerator.length || 0;\n          enumerator._enumerate();\n          if (enumerator._remaining === 0) {\n            lib$es6$promise$$internal$$fulfill(enumerator.promise, enumerator._result);\n          }\n        }\n      } else {\n        lib$es6$promise$$internal$$reject(enumerator.promise, enumerator._validationError());\n      }\n    }\n\n    lib$es6$promise$enumerator$$Enumerator.prototype._validateInput = function(input) {\n      return lib$es6$promise$utils$$isArray(input);\n    };\n\n    lib$es6$promise$enumerator$$Enumerator.prototype._validationError = function() {\n      return new Error('Array Methods must be provided an Array');\n    };\n\n    lib$es6$promise$enumerator$$Enumerator.prototype._init = function() {\n      this._result = new Array(this.length);\n    };\n\n    var lib$es6$promise$enumerator$$default = lib$es6$promise$enumerator$$Enumerator;\n\n    lib$es6$promise$enumerator$$Enumerator.prototype._enumerate = function() {\n      var enumerator = this;\n\n      var length  = enumerator.length;\n      var promise = enumerator.promise;\n      var input   = enumerator._input;\n\n      for (var i = 0; promise._state === lib$es6$promise$$internal$$PENDING && i < length; i++) {\n        enumerator._eachEntry(input[i], i);\n      }\n    };\n\n    lib$es6$promise$enumerator$$Enumerator.prototype._eachEntry = function(entry, i) {\n      var enumerator = this;\n      var c = enumerator._instanceConstructor;\n\n      if (lib$es6$promise$utils$$isMaybeThenable(entry)) {\n        if (entry.constructor === c && entry._state !== lib$es6$promise$$internal$$PENDING) {\n          entry._onerror = null;\n          enumerator._settledAt(entry._state, i, entry._result);\n        } else {\n          enumerator._willSettleAt(c.resolve(entry), i);\n        }\n      } else {\n        enumerator._remaining--;\n        enumerator._result[i] = entry;\n      }\n    };\n\n    lib$es6$promise$enumerator$$Enumerator.prototype._settledAt = function(state, i, value) {\n      var enumerator = this;\n      var promise = enumerator.promise;\n\n      if (promise._state === lib$es6$promise$$internal$$PENDING) {\n        enumerator._remaining--;\n\n        if (state === lib$es6$promise$$internal$$REJECTED) {\n          lib$es6$promise$$internal$$reject(promise, value);\n        } else {\n          enumerator._result[i] = value;\n        }\n      }\n\n      if (enumerator._remaining === 0) {\n        lib$es6$promise$$internal$$fulfill(promise, enumerator._result);\n      }\n    };\n\n    lib$es6$promise$enumerator$$Enumerator.prototype._willSettleAt = function(promise, i) {\n      var enumerator = this;\n\n      lib$es6$promise$$internal$$subscribe(promise, undefined, function(value) {\n        enumerator._settledAt(lib$es6$promise$$internal$$FULFILLED, i, value);\n      }, function(reason) {\n        enumerator._settledAt(lib$es6$promise$$internal$$REJECTED, i, reason);\n      });\n    };\n    function lib$es6$promise$promise$all$$all(entries) {\n      return new lib$es6$promise$enumerator$$default(this, entries).promise;\n    }\n    var lib$es6$promise$promise$all$$default = lib$es6$promise$promise$all$$all;\n    function lib$es6$promise$promise$race$$race(entries) {\n      /*jshint validthis:true */\n      var Constructor = this;\n\n      var promise = new Constructor(lib$es6$promise$$internal$$noop);\n\n      if (!lib$es6$promise$utils$$isArray(entries)) {\n        lib$es6$promise$$internal$$reject(promise, new TypeError('You must pass an array to race.'));\n        return promise;\n      }\n\n      var length = entries.length;\n\n      function onFulfillment(value) {\n        lib$es6$promise$$internal$$resolve(promise, value);\n      }\n\n      function onRejection(reason) {\n        lib$es6$promise$$internal$$reject(promise, reason);\n      }\n\n      for (var i = 0; promise._state === lib$es6$promise$$internal$$PENDING && i < length; i++) {\n        lib$es6$promise$$internal$$subscribe(Constructor.resolve(entries[i]), undefined, onFulfillment, onRejection);\n      }\n\n      return promise;\n    }\n    var lib$es6$promise$promise$race$$default = lib$es6$promise$promise$race$$race;\n    function lib$es6$promise$promise$resolve$$resolve(object) {\n      /*jshint validthis:true */\n      var Constructor = this;\n\n      if (object && typeof object === 'object' && object.constructor === Constructor) {\n        return object;\n      }\n\n      var promise = new Constructor(lib$es6$promise$$internal$$noop);\n      lib$es6$promise$$internal$$resolve(promise, object);\n      return promise;\n    }\n    var lib$es6$promise$promise$resolve$$default = lib$es6$promise$promise$resolve$$resolve;\n    function lib$es6$promise$promise$reject$$reject(reason) {\n      /*jshint validthis:true */\n      var Constructor = this;\n      var promise = new Constructor(lib$es6$promise$$internal$$noop);\n      lib$es6$promise$$internal$$reject(promise, reason);\n      return promise;\n    }\n    var lib$es6$promise$promise$reject$$default = lib$es6$promise$promise$reject$$reject;\n\n    var lib$es6$promise$promise$$counter = 0;\n\n    function lib$es6$promise$promise$$needsResolver() {\n      throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');\n    }\n\n    function lib$es6$promise$promise$$needsNew() {\n      throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");\n    }\n\n    var lib$es6$promise$promise$$default = lib$es6$promise$promise$$Promise;\n    /**\n      Promise objects represent the eventual result of an asynchronous operation. The\n      primary way of interacting with a promise is through its `then` method, which\n      registers callbacks to receive either a promise’s eventual value or the reason\n      why the promise cannot be fulfilled.\n\n      Terminology\n      -----------\n\n      - `promise` is an object or function with a `then` method whose behavior conforms to this specification.\n      - `thenable` is an object or function that defines a `then` method.\n      - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).\n      - `exception` is a value that is thrown using the throw statement.\n      - `reason` is a value that indicates why a promise was rejected.\n      - `settled` the final resting state of a promise, fulfilled or rejected.\n\n      A promise can be in one of three states: pending, fulfilled, or rejected.\n\n      Promises that are fulfilled have a fulfillment value and are in the fulfilled\n      state.  Promises that are rejected have a rejection reason and are in the\n      rejected state.  A fulfillment value is never a thenable.\n\n      Promises can also be said to *resolve* a value.  If this value is also a\n      promise, then the original promise's settled state will match the value's\n      settled state.  So a promise that *resolves* a promise that rejects will\n      itself reject, and a promise that *resolves* a promise that fulfills will\n      itself fulfill.\n\n\n      Basic Usage:\n      ------------\n\n      ```js\n      var promise = new Promise(function(resolve, reject) {\n        // on success\n        resolve(value);\n\n        // on failure\n        reject(reason);\n      });\n\n      promise.then(function(value) {\n        // on fulfillment\n      }, function(reason) {\n        // on rejection\n      });\n      ```\n\n      Advanced Usage:\n      ---------------\n\n      Promises shine when abstracting away asynchronous interactions such as\n      `XMLHttpRequest`s.\n\n      ```js\n      function getJSON(url) {\n        return new Promise(function(resolve, reject){\n          var xhr = new XMLHttpRequest();\n\n          xhr.open('GET', url);\n          xhr.onreadystatechange = handler;\n          xhr.responseType = 'json';\n          xhr.setRequestHeader('Accept', 'application/json');\n          xhr.send();\n\n          function handler() {\n            if (this.readyState === this.DONE) {\n              if (this.status === 200) {\n                resolve(this.response);\n              } else {\n                reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));\n              }\n            }\n          };\n        });\n      }\n\n      getJSON('/posts.json').then(function(json) {\n        // on fulfillment\n      }, function(reason) {\n        // on rejection\n      });\n      ```\n\n      Unlike callbacks, promises are great composable primitives.\n\n      ```js\n      Promise.all([\n        getJSON('/posts'),\n        getJSON('/comments')\n      ]).then(function(values){\n        values[0] // => postsJSON\n        values[1] // => commentsJSON\n\n        return values;\n      });\n      ```\n\n      @class Promise\n      @param {function} resolver\n      Useful for tooling.\n      @constructor\n    */\n    function lib$es6$promise$promise$$Promise(resolver) {\n      this._id = lib$es6$promise$promise$$counter++;\n      this._state = undefined;\n      this._result = undefined;\n      this._subscribers = [];\n\n      if (lib$es6$promise$$internal$$noop !== resolver) {\n        if (!lib$es6$promise$utils$$isFunction(resolver)) {\n          lib$es6$promise$promise$$needsResolver();\n        }\n\n        if (!(this instanceof lib$es6$promise$promise$$Promise)) {\n          lib$es6$promise$promise$$needsNew();\n        }\n\n        lib$es6$promise$$internal$$initializePromise(this, resolver);\n      }\n    }\n\n    lib$es6$promise$promise$$Promise.all = lib$es6$promise$promise$all$$default;\n    lib$es6$promise$promise$$Promise.race = lib$es6$promise$promise$race$$default;\n    lib$es6$promise$promise$$Promise.resolve = lib$es6$promise$promise$resolve$$default;\n    lib$es6$promise$promise$$Promise.reject = lib$es6$promise$promise$reject$$default;\n\n    lib$es6$promise$promise$$Promise.prototype = {\n      constructor: lib$es6$promise$promise$$Promise,\n\n    /**\n      The primary way of interacting with a promise is through its `then` method,\n      which registers callbacks to receive either a promise's eventual value or the\n      reason why the promise cannot be fulfilled.\n\n      ```js\n      findUser().then(function(user){\n        // user is available\n      }, function(reason){\n        // user is unavailable, and you are given the reason why\n      });\n      ```\n\n      Chaining\n      --------\n\n      The return value of `then` is itself a promise.  This second, 'downstream'\n      promise is resolved with the return value of the first promise's fulfillment\n      or rejection handler, or rejected if the handler throws an exception.\n\n      ```js\n      findUser().then(function (user) {\n        return user.name;\n      }, function (reason) {\n        return 'default name';\n      }).then(function (userName) {\n        // If `findUser` fulfilled, `userName` will be the user's name, otherwise it\n        // will be `'default name'`\n      });\n\n      findUser().then(function (user) {\n        throw new Error('Found user, but still unhappy');\n      }, function (reason) {\n        throw new Error('`findUser` rejected and we're unhappy');\n      }).then(function (value) {\n        // never reached\n      }, function (reason) {\n        // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.\n        // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.\n      });\n      ```\n      If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.\n\n      ```js\n      findUser().then(function (user) {\n        throw new PedagogicalException('Upstream error');\n      }).then(function (value) {\n        // never reached\n      }).then(function (value) {\n        // never reached\n      }, function (reason) {\n        // The `PedgagocialException` is propagated all the way down to here\n      });\n      ```\n\n      Assimilation\n      ------------\n\n      Sometimes the value you want to propagate to a downstream promise can only be\n      retrieved asynchronously. This can be achieved by returning a promise in the\n      fulfillment or rejection handler. The downstream promise will then be pending\n      until the returned promise is settled. This is called *assimilation*.\n\n      ```js\n      findUser().then(function (user) {\n        return findCommentsByAuthor(user);\n      }).then(function (comments) {\n        // The user's comments are now available\n      });\n      ```\n\n      If the assimliated promise rejects, then the downstream promise will also reject.\n\n      ```js\n      findUser().then(function (user) {\n        return findCommentsByAuthor(user);\n      }).then(function (comments) {\n        // If `findCommentsByAuthor` fulfills, we'll have the value here\n      }, function (reason) {\n        // If `findCommentsByAuthor` rejects, we'll have the reason here\n      });\n      ```\n\n      Simple Example\n      --------------\n\n      Synchronous Example\n\n      ```javascript\n      var result;\n\n      try {\n        result = findResult();\n        // success\n      } catch(reason) {\n        // failure\n      }\n      ```\n\n      Errback Example\n\n      ```js\n      findResult(function(result, err){\n        if (err) {\n          // failure\n        } else {\n          // success\n        }\n      });\n      ```\n\n      Promise Example;\n\n      ```javascript\n      findResult().then(function(result){\n        // success\n      }, function(reason){\n        // failure\n      });\n      ```\n\n      Advanced Example\n      --------------\n\n      Synchronous Example\n\n      ```javascript\n      var author, books;\n\n      try {\n        author = findAuthor();\n        books  = findBooksByAuthor(author);\n        // success\n      } catch(reason) {\n        // failure\n      }\n      ```\n\n      Errback Example\n\n      ```js\n\n      function foundBooks(books) {\n\n      }\n\n      function failure(reason) {\n\n      }\n\n      findAuthor(function(author, err){\n        if (err) {\n          failure(err);\n          // failure\n        } else {\n          try {\n            findBoooksByAuthor(author, function(books, err) {\n              if (err) {\n                failure(err);\n              } else {\n                try {\n                  foundBooks(books);\n                } catch(reason) {\n                  failure(reason);\n                }\n              }\n            });\n          } catch(error) {\n            failure(err);\n          }\n          // success\n        }\n      });\n      ```\n\n      Promise Example;\n\n      ```javascript\n      findAuthor().\n        then(findBooksByAuthor).\n        then(function(books){\n          // found books\n      }).catch(function(reason){\n        // something went wrong\n      });\n      ```\n\n      @method then\n      @param {Function} onFulfilled\n      @param {Function} onRejected\n      Useful for tooling.\n      @return {Promise}\n    */\n      then: function(onFulfillment, onRejection) {\n        var parent = this;\n        var state = parent._state;\n\n        if (state === lib$es6$promise$$internal$$FULFILLED && !onFulfillment || state === lib$es6$promise$$internal$$REJECTED && !onRejection) {\n          return this;\n        }\n\n        var child = new this.constructor(lib$es6$promise$$internal$$noop);\n        var result = parent._result;\n\n        if (state) {\n          var callback = arguments[state - 1];\n          lib$es6$promise$asap$$default(function(){\n            lib$es6$promise$$internal$$invokeCallback(state, child, callback, result);\n          });\n        } else {\n          lib$es6$promise$$internal$$subscribe(parent, child, onFulfillment, onRejection);\n        }\n\n        return child;\n      },\n\n    /**\n      `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same\n      as the catch block of a try/catch statement.\n\n      ```js\n      function findAuthor(){\n        throw new Error('couldn't find that author');\n      }\n\n      // synchronous\n      try {\n        findAuthor();\n      } catch(reason) {\n        // something went wrong\n      }\n\n      // async with promises\n      findAuthor().catch(function(reason){\n        // something went wrong\n      });\n      ```\n\n      @method catch\n      @param {Function} onRejection\n      Useful for tooling.\n      @return {Promise}\n    */\n      'catch': function(onRejection) {\n        return this.then(null, onRejection);\n      }\n    };\n    function lib$es6$promise$polyfill$$polyfill() {\n      var local;\n\n      if (typeof global !== 'undefined') {\n          local = global;\n      } else if (typeof self !== 'undefined') {\n          local = self;\n      } else {\n          try {\n              local = Function('return this')();\n          } catch (e) {\n              throw new Error('polyfill failed because global object is unavailable in this environment');\n          }\n      }\n\n      var P = local.Promise;\n\n      if (P && Object.prototype.toString.call(P.resolve()) === '[object Promise]' && !P.cast) {\n        return;\n      }\n\n      local.Promise = lib$es6$promise$promise$$default;\n    }\n    var lib$es6$promise$polyfill$$default = lib$es6$promise$polyfill$$polyfill;\n\n    var lib$es6$promise$umd$$ES6Promise = {\n      'Promise': lib$es6$promise$promise$$default,\n      'polyfill': lib$es6$promise$polyfill$$default\n    };\n\n    /* global define:true module:true window: true */\n    if (typeof define === 'function' && define['amd']) {\n      define(function() { return lib$es6$promise$umd$$ES6Promise; });\n    } else if (typeof module !== 'undefined' && module['exports']) {\n      module['exports'] = lib$es6$promise$umd$$ES6Promise;\n    } else if (typeof this !== 'undefined') {\n      this['ES6Promise'] = lib$es6$promise$umd$$ES6Promise;\n    }\n\n    lib$es6$promise$polyfill$$default();\n}).call(this);\n\n","(function (root, factory) {\n    'use strict';\n    // Universal Module Definition (UMD) to support AMD, CommonJS/Node.js, Rhino, and browsers.\n    if (typeof define === 'function' && define.amd) {\n        define('stackframe', [], factory);\n    } else if (typeof exports === 'object') {\n        module.exports = factory();\n    } else {\n        root.StackFrame = factory();\n    }\n}(this, function () {\n    'use strict';\n    function _isNumber(n) {\n        return !isNaN(parseFloat(n)) && isFinite(n);\n    }\n\n    function StackFrame(functionName, args, fileName, lineNumber, columnNumber) {\n        if (functionName !== undefined) {\n            this.setFunctionName(functionName);\n        }\n        if (args !== undefined) {\n            this.setArgs(args);\n        }\n        if (fileName !== undefined) {\n            this.setFileName(fileName);\n        }\n        if (lineNumber !== undefined) {\n            this.setLineNumber(lineNumber);\n        }\n        if (columnNumber !== undefined) {\n            this.setColumnNumber(columnNumber);\n        }\n    }\n\n    StackFrame.prototype = {\n        getFunctionName: function () {\n            return this.functionName;\n        },\n        setFunctionName: function (v) {\n            this.functionName = String(v);\n        },\n\n        getArgs: function () {\n            return this.args;\n        },\n        setArgs: function (v) {\n            if (Object.prototype.toString.call(v) !== '[object Array]') {\n                throw new TypeError('Args must be an Array');\n            }\n            this.args = v;\n        },\n\n        // NOTE: Property name may be misleading as it includes the path,\n        // but it somewhat mirrors V8's JavaScriptStackTraceApi\n        // https://code.google.com/p/v8/wiki/JavaScriptStackTraceApi and Gecko's\n        // http://mxr.mozilla.org/mozilla-central/source/xpcom/base/nsIException.idl#14\n        getFileName: function () {\n            return this.fileName;\n        },\n        setFileName: function (v) {\n            this.fileName = String(v);\n        },\n\n        getLineNumber: function () {\n            return this.lineNumber;\n        },\n        setLineNumber: function (v) {\n            if (!_isNumber(v)) {\n                throw new TypeError('Line Number must be a Number');\n            }\n            this.lineNumber = Number(v);\n        },\n\n        getColumnNumber: function () {\n            return this.columnNumber;\n        },\n        setColumnNumber: function (v) {\n            if (!_isNumber(v)) {\n                throw new TypeError('Column Number must be a Number');\n            }\n            this.columnNumber = Number(v);\n        },\n\n        toString: function() {\n            var functionName = this.getFunctionName() || '{anonymous}';\n            var args = '(' + (this.getArgs() || []).join(',') + ')';\n            var fileName = this.getFileName() ? ('@' + this.getFileName()) : '';\n            var lineNumber = _isNumber(this.getLineNumber()) ? (':' + this.getLineNumber()) : '';\n            var columnNumber = _isNumber(this.getColumnNumber()) ? (':' + this.getColumnNumber()) : '';\n            return functionName + args + fileName + lineNumber + columnNumber;\n        }\n    };\n\n    return StackFrame;\n}));\n",null,null,"(function (root, factory) {\n    'use strict';\n    // Universal Module Definition (UMD) to support AMD, CommonJS/Node.js, Rhino, and browsers.\n    if (typeof define === 'function' && define.amd) {\n        define('stack-generator', ['stackframe'], factory);\n    } else if (typeof exports === 'object') {\n        module.exports = factory(require('stackframe'));\n    } else {\n        root.StackGenerator = factory(root.StackFrame);\n    }\n}(this, function (StackFrame) {\n    return {\n        backtrace: function StackGenerator$$backtrace(opts) {\n            var stack = [];\n            var maxStackSize = 10;\n\n            if (typeof opts === 'object' && typeof opts.maxStackSize === 'number') {\n                maxStackSize = opts.maxStackSize;\n            }\n\n            var curr = arguments.callee;\n            while (curr && stack.length < maxStackSize) {\n                var args = [].slice.call(curr['arguments']);\n                if (/function(?:\\s+([\\w$]+))?\\s*\\(/.test(curr.toString())) {\n                    stack.push(new StackFrame(RegExp.$1 || undefined, args));\n                } else {\n                    stack.push(new StackFrame(undefined, args));\n                }\n\n                try {\n                    curr = curr.caller;\n                } catch (e) {\n                    break;\n                }\n            }\n            return stack;\n        }\n    };\n}));\n","(function (root, factory) {\n    'use strict';\n    // Universal Module Definition (UMD) to support AMD, CommonJS/Node.js, Rhino, and browsers.\n    if (typeof define === 'function' && define.amd) {\n        define('stacktrace-gps', ['source-map', 'es6-promise', 'stackframe'], factory);\n    } else if (typeof exports === 'object') {\n        module.exports = factory(require('source-map/lib/source-map/source-map-consumer'), require('es6-promise'), require('stackframe'));\n    } else {\n        root.StackTraceGPS = factory(root.SourceMap, root.ES6Promise, root.StackFrame);\n    }\n}(this, function (SourceMap, ES6Promise) {\n    'use strict';\n    ES6Promise.polyfill();\n    var Promise = ES6Promise.Promise;\n\n    /**\n     * Create XHR or equivalent object for this environment.\n     * @returns XMLHttpRequest, XDomainRequest or ActiveXObject\n     * @private\n     */\n    function _createXMLHTTPObject() {\n        var xmlhttp;\n        var XMLHttpFactories = [\n            function () {\n                return new XMLHttpRequest();\n            }, function () {\n                return new ActiveXObject('Microsoft.XMLHTTP');\n            }\n        ];\n        for (var i = 0; i < XMLHttpFactories.length; i++) {\n            try {\n                xmlhttp = XMLHttpFactories[i]();\n                // Use memoization to cache the factory\n                _createXMLHTTPObject = XMLHttpFactories[i]; // jshint ignore:line\n                return xmlhttp;\n            } catch (e) {\n            }\n        }\n    }\n\n    /**\n     * Make a X-Domain request to url and callback.\n     *\n     * @param url [String]\n     * @param callback [Function] to callback on completion\n     * @param errback [Function] to callback on error\n     */\n    function _xdr(url, callback, errback) {\n        var req = _createXMLHTTPObject();\n        req.open('get', url);\n        req.onerror = errback;\n        req.onreadystatechange = function onreadystatechange() {\n            if (req.readyState === 4) {\n                if (req.status >= 200 && req.status < 400) {\n                    return callback(req.responseText);\n                } else {\n                    errback(new Error('Unable to retrieve ' + url));\n                }\n            }\n        };\n        req.send();\n    }\n\n    function _findFunctionName(source, lineNumber, columnNumber) {\n        // function {name}({args}) m[1]=name m[2]=args\n        var reFunctionDeclaration = /function\\s+([^(]*?)\\s*\\(([^)]*)\\)/;\n        // {name} = function ({args}) TODO args capture\n        var reFunctionExpression = /['\"]?([$_A-Za-z][$_A-Za-z0-9]*)['\"]?\\s*[:=]\\s*function\\b/;\n        // {name} = eval()\n        var reFunctionEvaluation = /['\"]?([$_A-Za-z][$_A-Za-z0-9]*)['\"]?\\s*[:=]\\s*(?:eval|new Function)\\b/;\n        var lines = source.split(\"\\n\");\n\n        // Walk backwards in the source lines until we find the line which matches one of the patterns above\n        var code = '', line, maxLines = Math.min(lineNumber, 20), m, commentPos;\n        for (var i = 0; i < maxLines; ++i) {\n            // lineNo is 1-based, source[] is 0-based\n            line = lines[lineNumber - i - 1];\n            commentPos = line.indexOf('//');\n            if (commentPos >= 0) {\n                line = line.substr(0, commentPos);\n            }\n\n            if (line) {\n                code = line + code;\n                m = reFunctionExpression.exec(code);\n                if (m && m[1]) {\n                    return m[1];\n                }\n                m = reFunctionDeclaration.exec(code);\n                if (m && m[1]) {\n                    //return m[1] + \"(\" + (m[2] || \"\") + \")\";\n                    return m[1];\n                }\n                m = reFunctionEvaluation.exec(code);\n                if (m && m[1]) {\n                    return m[1];\n                }\n            }\n        }\n        return undefined;\n    }\n\n    function _ensureSupportedEnvironment() {\n        if (typeof Object.defineProperty !== 'function' || typeof Object.create !== 'function') {\n            throw new Error('Unable to consume source maps in older browsers');\n        }\n    }\n\n    function _ensureStackFrameIsLegit(stackframe) {\n        if (typeof stackframe !== 'object') {\n            throw new TypeError('Given StackFrame is not an object');\n        } else if (typeof stackframe.fileName !== 'string') {\n            throw new TypeError('Given file name is not a String');\n        } else if (typeof stackframe.lineNumber !== 'number' || stackframe.lineNumber % 1 !== 0 || stackframe.lineNumber < 1) {\n            throw new TypeError('Given line number must be a positive integer');\n        } else if (typeof stackframe.columnNumber !== 'number' || stackframe.columnNumber % 1 !== 0 || stackframe.columnNumber < 0) {\n            throw new TypeError('Given column number must be a non-negative integer');\n        }\n        return true;\n    }\n\n    function _findSourceMappingURL(source) {\n        var m = /\\/\\/[#@] ?sourceMappingURL=([^\\s'\"]+)$/.exec(source);\n        if (m && m[1]) {\n            return m[1];\n        } else {\n            throw new Error('sourceMappingURL not found');\n        }\n    }\n\n    function _newLocationInfoFromSourceMap(rawSourceMap, args, lineNumber, columnNumber) {\n        var loc = new SourceMap.SourceMapConsumer(rawSourceMap)\n            .originalPositionFor({line: lineNumber, column: columnNumber});\n        return new StackFrame(loc.name, args, loc.source, loc.line, loc.column);\n    }\n\n    /**\n     * @param opts: [Object] options.\n     *      opts.sourceCache = {url: \"Source String\"} => preload source cache\n     *      opts.offline = True to prevent network requests.\n     *              Best effort without sources or source maps.\n     */\n    return function StackTraceGPS(opts) {\n        if (!(this instanceof StackTraceGPS)) {\n            return new StackTraceGPS(opts);\n        }\n        opts = opts || {};\n\n        this.sourceCache = opts.sourceCache || {};\n\n        this._get = function _get(location) {\n            return new Promise(function (resolve, reject) {\n                if (this.sourceCache[location]) {\n                    resolve(this.sourceCache[location]);\n                } else if (opts.offline) {\n                    reject(new Error('Cannot make network requests in offline mode'));\n                } else {\n                    _xdr(location, function (source) {\n                        this.sourceCache[location] = source;\n                        resolve(source);\n                    }.bind(this), reject);\n                }\n            }.bind(this));\n        };\n\n        /**\n         * Given a StackFrame, enhance function name and use source maps for a\n         * better StackFrame.\n         *\n         * @param stackframe - {StackFrame}-like object\n         *      {fileName: 'path/to/file.js', lineNumber: 100, columnNumber: 5}\n         * @return StackFrame with source-mapped location\n         */\n        this.pinpoint = function StackTraceGPS$$pinpoint(stackframe) {\n            return this.getMappedLocation(stackframe)\n                .then(this.findFunctionName.bind(this));\n        };\n\n        /**\n         * Given a StackFrame, guess function name from location information.\n         *\n         * @param stackframe - {StackFrame}-like object\n         *      {fileName: 'path/to/file.js', lineNumber: 100, columnNumber: 5}\n         * @return StackFrame with guessed function name\n         */\n        this.findFunctionName = function StackTraceGPS$$findFunctionName(stackframe) {\n            return new Promise(function (resolve, reject) {\n                _ensureStackFrameIsLegit(stackframe);\n                this._get(stackframe.fileName).then(function getSourceCallback(source) {\n                    var guessedFunctionName = _findFunctionName(source, stackframe.lineNumber, stackframe.columnNumber);\n                    resolve(new StackFrame(guessedFunctionName, stackframe.args, stackframe.fileName, stackframe.lineNumber, stackframe.columnNumber));\n                }, reject);\n            }.bind(this));\n        };\n\n        /**\n         * Given a StackFrame, seek source-mapped location and return new enhanced StackFrame.\n         *\n         * @param stackframe - {StackFrame}-like object\n         *      {fileName: 'path/to/file.js', lineNumber: 100, columnNumber: 5}\n         * @return StackFrame with source-mapped location\n         */\n        this.getMappedLocation = function StackTraceGPS$$getMappedLocation(stackframe) {\n            return new Promise(function (resolve, reject) {\n                _ensureSupportedEnvironment();\n                _ensureStackFrameIsLegit(stackframe);\n\n                this._get(stackframe.fileName).then(function (source) {\n                    this._get(_findSourceMappingURL(source)).then(function (map) {\n                        var lineNumber = stackframe.lineNumber;\n                        var columnNumber = stackframe.columnNumber;\n                        resolve(_newLocationInfoFromSourceMap(map, stackframe.args, lineNumber, columnNumber));\n                    }, reject)['catch'](reject);\n                }.bind(this), reject)['catch'](reject);\n            }.bind(this));\n        };\n    };\n}));\n",null,"export interface IBootstrapper {\n  register():void;\n}\n\nexport interface ILastReferenceIdManager {\r\n  getLast(): string;\r\n  clearLast(): void;\r\n  setLast(eventId:string): void;\r\n}\r\n\nexport interface ILog {\r\n  info(message:string);\r\n  warn(message:string);\r\n  error(message:string);\r\n}\r\n\nexport interface IEvent {\r\n  type?:string;\r\n  source?:string;\r\n  date?:Date;\r\n  tags?:string[];\r\n  message?:string;\r\n  geo?:string;\r\n  value?:number;\r\n  data?:any;\r\n  reference_id?:string;\r\n  session_id?:string;\r\n}\r\n\n                                          \r\n\r\nexport interface IEventQueue {\r\n  enqueue(event:IEvent);\r\n  process();\r\n  suspendProcessing(durationInMinutes?:number, discardFutureQueuedItems?:boolean, clearQueue?:boolean);\r\n}\r\n\nexport interface IEnvironmentInfo {\n  processor_count?:number;\n  total_physical_memory?:number;\n  available_physical_memory?:number;\n  command_line?:string;\n  process_name?:string;\n  process_id?:string;\n  process_memory_size?:number;\n  thread_id?:string;\n  architecture?:string;\n  o_s_name?:string;\n  o_s_version?:string;\n  ip_address?:string;\n  machine_name?:string;\n  install_id?:string;\n  runtime_version?:string;\n  data?:any;\n}\n\nexport class ContextData {\r\n  public setException(exception:Error): void {\r\n    this['@@_Exception'] = exception;\r\n  }\r\n\r\n  public get hasException(): boolean {\r\n    return !!this['@@_Exception']\r\n  }\r\n\r\n  public getException(): Error {\r\n    if (!this.hasException) {\r\n      return null;\r\n    }\r\n\r\n    return this['@@_Exception'];\r\n  }\r\n\r\n  public markAsUnhandledError(): void {\r\n    this['@@_IsUnhandledError'] = true;\r\n  }\r\n\r\n  public get isUnhandledError(): boolean {\r\n    return !!this['@@_IsUnhandledError'];\r\n  }\r\n\r\n  public setSubmissionMethod(method:string): void {\r\n    if (method && method.length > 0) {\r\n      this['@@_SubmissionMethod'] = method;\r\n    }\r\n  }\r\n\r\n  public getSubmissionMethod(): string {\r\n    if (!!this['@@_SubmissionMethod']) {\r\n      return null;\r\n    }\r\n\r\n    return this['@@_SubmissionMethod'];\r\n  }\r\n}\r\n\n                                                                                                                                   \r\n\r\nexport interface IEnvironmentInfoCollector {\r\n  getEnvironmentInfo(context:EventPluginContext):IEnvironmentInfo;\r\n}\r\n\n                                                                                                               \r\n\r\nexport interface IErrorParser {\r\n  parse(context:EventPluginContext, exception:Error):Promise<IError>;\r\n}\r\n\n                                                                                                                \n\nexport interface IModuleCollector {\n  getModules(context:EventPluginContext):IModule[];\n}\n\n                                                                                                                           \r\n\r\nexport interface IRequestInfoCollector {\r\n  getRequestInfo(context:EventPluginContext):IRequestInfo;\r\n}\r\n\nexport interface IStorage<T>{\r\n  save<T>(path:string, value:T): boolean;\r\n  get(searchPattern?:string, limit?:number): T[];\r\n  clear(searchPattern?:string);\r\n  count(searchPattern?:string): number;\r\n}\r\n\n                                                                                                                                                                                                                                                                                               \r\n\r\nexport interface ISubmissionClient {\r\n  submit(events:IEvent[], config:Configuration): Promise<SubmissionResponse>;\r\n  submitDescription(referenceId:string, description:IUserDescription, config:Configuration): Promise<SubmissionResponse>;\r\n  getSettings(config:Configuration): Promise<SettingsResponse>;\r\n}\r\n\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \n\nexport interface IConfigurationSettings {\n  apiKey?:string;\n  serverUrl?:string;\n  environmentInfoCollector?:IEnvironmentInfoCollector;\n  errorParser?:IErrorParser;\n  lastReferenceIdManager?:ILastReferenceIdManager;\n  log?:ILog;\n  moduleCollector?:IModuleCollector;\n  requestInfoCollector?:IRequestInfoCollector;\n  submissionBatchSize?:number;\n  submissionClient?:ISubmissionClient;\n  storage?:IStorage<any>;\n  queue?:IEventQueue;\n}\n\n                                                                    \r\n\r\nexport class InMemoryLastReferenceIdManager implements ILastReferenceIdManager {\r\n  private _lastReferenceId:string = null;\r\n\r\n  getLast(): string {\r\n    return this._lastReferenceId;\r\n  }\r\n\r\n  clearLast():void {\r\n    this._lastReferenceId = null;\r\n  }\r\n\r\n  setLast(eventId:string):void {\r\n    this._lastReferenceId = eventId;\r\n  }\r\n}\r\n\n                              \n\nexport class ConsoleLog implements ILog {\n  public info(message) {\n    if (console && console.info) {\n      console.info(`[INFO] Exceptionless:${message}`)\n    }\n  }\n\n  public warn(message) {\n    if (console && console.warn) {\n      console.warn(`[Warn] Exceptionless:${message}`)\n    }\n  }\n\n  public error(message) {\n    if (console && console.error) {\n      console.error(`[Error] Exceptionless:${message}`)\n    }\n  }\n}\n\n                              \r\n\r\nexport class NullLog implements ILog {\r\n  public info(message) {}\r\n  public warn(message) {}\r\n  public error(message) {}\r\n}\r\n\nexport interface IUserInfo {\n  identity?:string;\n  name?:string;\n  data?:any;\n}\n\n                                                                                                          \r\n\r\nexport interface IEventPlugin {\r\n  priority?:number;\r\n  name?:string;\r\n  run(context:EventPluginContext): Promise<any>;\r\n}\r\n\n                                                                                                                                                                                                                                                \r\n\r\nexport class EventPluginContext {\r\n  public client:ExceptionlessClient;\r\n  public event:IEvent;\r\n  public contextData:ContextData;\r\n  public cancel:boolean = false;\r\n\r\n  constructor(client:ExceptionlessClient, event:IEvent, contextData?:ContextData) {\r\n    this.client = client;\r\n    this.event = event;\r\n    this.contextData = contextData ? contextData : new ContextData();\r\n  }\r\n\r\n  public get log(): ILog {\r\n    return this.client.config.log;\r\n  }\r\n}\r\n\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \r\n\r\nexport class EventPluginManager {\r\n  public static run(context:EventPluginContext): Promise<any> {\r\n    return context.client.config.plugins.reduce((promise:Promise<any>, plugin:IEventPlugin) => {\r\n      return promise.then(() => {\r\n        return plugin.run(context);\r\n      });\r\n    }, Promise.resolve());\r\n  }\r\n\r\n  public static addDefaultPlugins(config:Configuration): void {\r\n    config.addPlugin(new ConfigurationDefaultsPlugin());\r\n    config.addPlugin(new ErrorPlugin());\r\n    config.addPlugin(new DuplicateCheckerPlugin());\r\n    config.addPlugin(new ModuleInfoPlugin());\r\n    config.addPlugin(new RequestInfoPlugin());\r\n    config.addPlugin(new EnvironmentInfoPlugin())\r\n    config.addPlugin(new SubmissionMethodPlugin());\r\n  }\r\n}\r\n\n                                                                                                                                                  \r\n\r\nexport class ReferenceIdPlugin implements IEventPlugin {\r\n  public priority:number = 20;\r\n  public name:string = 'ReferenceIdPlugin';\r\n\r\n  run(context:EventPluginContext): Promise<any> {\r\n    if ((!context.event.reference_id || context.event.reference_id.length === 0) && context.event.type === 'error') {\r\n      context.event.reference_id = Utils.guid().replace('-', '').substring(0, 10);\r\n    }\r\n\r\n    return Promise.resolve();\r\n  }\r\n}\r\n\n                                                                                                                                                                                                                                                                       \n\nexport class DefaultEventQueue implements IEventQueue {\n  private _config:Configuration;\n  private _suspendProcessingUntil:Date;\n  private _discardQueuedItemsUntil:Date;\n  private _processingQueue:boolean = false;\n  private _queueTimer:any;\n\n  constructor(config:Configuration) {\n    this._config = config;\n  }\n\n  public enqueue(event:IEvent) {\n    this.ensureQueueTimer();\n\n    if (this.areQueuedItemsDiscarded()) {\n      this._config.log.info('Queue items are currently being discarded. The event will not be queued.');\n      return;\n    }\n\n    var key = `${this.queuePath()}-${new Date().toJSON()}-${Utils.randomNumber()}`;\n    this._config.log.info(`Enqueuing event: ${key}`);\n    return this._config.storage.save(key, event);\n  }\n\n  public process() {\n    this.ensureQueueTimer();\n\n    if (this._processingQueue) {\n      return;\n    }\n\n    this._config.log.info('Processing queue...');\n    if (!this._config.enabled) {\n      this._config.log.info('Configuration is disabled. The queue will not be processed.');\n      return;\n    }\n\n    if (!this._config.apiKey || this._config.apiKey.length < 10) {\n      this._config.log.info('ApiKey is not set. The queue will not be processed.');\n      return;\n    }\n\n    this._processingQueue = true;\n\n    try {\n      var events = this._config.storage.get(this.queuePath(), this._config.submissionBatchSize);\n      if (!events || events.length == 0) {\n        this._config.log.info('There are currently no queued events to process.');\n        return;\n      }\n\n      this._config.log.info(`Sending ${events.length} events to ${this._config.serverUrl}.`);\n      this._config.submissionClient.submit(events, this._config)\n        .then(\n        (response:SubmissionResponse) => this.processSubmissionResponse(response, events),\n        (response:SubmissionResponse) => this.processSubmissionResponse(response, events))\n        .then(() => {\n          this._config.log.info('Finished processing queue.');\n          this._processingQueue = false;\n        });\n    } catch (ex) {\n      this._config.log.error(`An error occurred while processing the queue: ${ex}`);\n      this.suspendProcessing();\n      this._processingQueue = false;\n    }\n  }\n\n  private processSubmissionResponse(response:SubmissionResponse, events:IEvent[]){\n    if (response.success) {\n      this._config.log.info(`Sent ${events.length} events to ${this._config.serverUrl}.`);\n      return;\n    }\n\n    if (response.serviceUnavailable) {\n      // You are currently over your rate limit or the servers are under stress.\n      this._config.log.error('Server returned service unavailable.');\n      this.suspendProcessing();\n      this.requeueEvents(events);\n      return;\n    }\n\n    if (response.paymentRequired) {\n      // If the organization over the rate limit then discard the event.\n      this._config.log.info('Too many events have been submitted, please upgrade your plan.');\n      this.suspendProcessing(null, true, true);\n      return;\n    }\n\n    if (response.unableToAuthenticate) {\n      // The api key was suspended or could not be authorized.\n      this._config.log.info('Unable to authenticate, please check your configuration. The event will not be submitted.');\n      this.suspendProcessing(15);\n      return;\n    }\n\n    if (response.notFound || response.badRequest) {\n      // The service end point could not be found.\n      this._config.log.error(`Error while trying to submit data: ${response.message}`);\n      this.suspendProcessing(60 * 4);\n      return;\n    }\n\n    if (response.requestEntityTooLarge) {\n      if (this._config.submissionBatchSize > 1) {\n        this._config.log.error('Event submission discarded for being too large. The event will be retried with a smaller events size.');\n        this._config.submissionBatchSize = Math.max(1, Math.round(this._config.submissionBatchSize / 1.5));\n        this.requeueEvents(events);\n      } else {\n        this._config.log.error('Event submission discarded for being too large. The event will not be submitted.');\n      }\n\n      return;\n    }\n\n    if (!response.success) {\n      this._config.log.error(`An error occurred while submitting events: ${ response.message}`);\n      this.suspendProcessing();\n      this.requeueEvents(events);\n    }\n  }\n\n  private ensureQueueTimer() : void {\n    if (!this._queueTimer) {\n      this._queueTimer = setInterval(() => this.onProcessQueue(), 10000);\n    }\n  }\n\n  private onProcessQueue(): void {\n    if (!this.isQueueProcessingSuspended() && !this._processingQueue) {\n      this.process();\n    }\n  }\n\n  public suspendProcessing(durationInMinutes?:number, discardFutureQueuedItems?:boolean, clearQueue?:boolean): void {\n    if (!durationInMinutes || durationInMinutes <= 0) {\n      durationInMinutes = 5;\n    }\n\n    this._config.log.info(`Suspending processing for ${durationInMinutes} minutes.`);\n    this._suspendProcessingUntil = new Date(new Date().getTime() + (durationInMinutes * 60000));\n\n    if (discardFutureQueuedItems) {\n      this._discardQueuedItemsUntil = new Date(new Date().getTime() + (durationInMinutes * 60000));\n    }\n\n    if (!clearQueue) {\n      return;\n    }\n\n    // Account is over the limit and we want to ensure that the sample size being sent in will contain newer errors.\n    try {\n      this._config.storage.clear(this.queuePath());\n    } catch (Exception) { }\n  }\n\n  private requeueEvents(events:IEvent[]): void {\n    this._config.log.info(`Requeuing ${events.length} events.`);\n\n    for (var index = 0; index < events.length; index++) {\n      this.enqueue(events[index]);\n    }\n  }\n\n  private isQueueProcessingSuspended(): boolean {\n    return this._suspendProcessingUntil && this._suspendProcessingUntil > new Date();\n  }\n\n  private areQueuedItemsDiscarded(): boolean {\n    return this._discardQueuedItemsUntil && this._discardQueuedItemsUntil > new Date();\n  }\n\n  private queuePath(): string {\n    return 'ex-q';\n  }\n}\n\n                                      \r\n\r\nexport class InMemoryStorage<T> implements IStorage<T> {\r\n  private _items = {};\r\n\r\n  public save<T>(path:string, value:T):boolean {\r\n    this._items[path] = value;\r\n    return true;\r\n  }\r\n\r\n  public get(searchPattern?:string, limit?:number):T[] {\r\n    var results = [];\r\n    var regex = new RegExp(searchPattern || '.*');\r\n\r\n    for (var key in this._items) {\r\n      if (results.length >= limit) {\r\n        break;\r\n      }\r\n\r\n      if (regex.test(key)) {\r\n        results.push(this._items[key]);\r\n        delete this._items[key];\r\n      }\r\n    }\r\n\r\n    return results;\r\n  }\r\n\r\n  public clear(searchPattern?:string) {\r\n    if (!searchPattern) {\r\n      this._items = {};\r\n      return;\r\n    }\r\n\r\n    var regex = new RegExp(searchPattern);\r\n    for (var key in this._items) {\r\n      if (regex.test(key)) {\r\n        delete this._items[key];\r\n      }\r\n    }\r\n  }\r\n\r\n  public count(searchPattern?:string):number {\r\n    var regex = new RegExp(searchPattern || '.*');\r\n    var results = [];\r\n    for (var key in this._items) {\r\n      if (regex.test(key)) {\r\n        results.push(key);\r\n      }\r\n    }\r\n\r\n    return results.length;\r\n  }\r\n}\r\n\nexport class Utils {\r\n  public static getHashCode(source:string): string {\r\n    if (!source || source.length === 0) {\r\n      return null;\r\n    }\r\n\r\n    var hash:number = 0;\r\n    for (var index = 0; index < source.length; index++) {\r\n      var character   = source.charCodeAt(index);\r\n      hash  = ((hash << 5) - hash) + character;\r\n      hash |= 0;\r\n    }\r\n\r\n    return hash.toString();\r\n  }\r\n\r\n  public static guid(): string {\r\n    function s4() {\r\n      return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\r\n    }\r\n\r\n    return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\r\n  }\r\n\r\n  public static merge(defaultValues:any, values:any) {\r\n    var result = {};\r\n\r\n    for (var key in defaultValues || {}) {\r\n      if (!!defaultValues[key]) {\r\n        result[key] = defaultValues[key];\r\n      }\r\n    }\r\n\r\n    for (var key in values || {}) {\r\n      if (!!values[key]) {\r\n        result[key] = values[key];\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  public static parseVersion(source:string): string {\r\n    if (!source) {\r\n      return null;\r\n    }\r\n\r\n    var versionRegex = /(v?((\\d+)\\.(\\d+)(\\.(\\d+))?)(?:-([\\dA-Za-z\\-]+(?:\\.[\\dA-Za-z\\-]+)*))?(?:\\+([\\dA-Za-z\\-]+(?:\\.[\\dA-Za-z\\-]+)*))?)/;\r\n    var matches = versionRegex.exec(source);\r\n    if (matches && matches.length > 0) {\r\n      return matches[0];\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  public static parseQueryString(query:string) {\r\n    if (!query || query.length === 0) {\r\n      return null;\r\n    }\r\n\r\n    var pairs = query.split('&');\r\n    if (pairs.length === 0) {\r\n      return null;\r\n    }\r\n\r\n    var result = {};\r\n    for (var index = 0; index < pairs.length; index++) {\r\n      var pair = pairs[index].split('=');\r\n      result[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  public static randomNumber(): number {\r\n    return Math.floor(Math.random() * 9007199254740992);\r\n  }\r\n\r\n  public static stringify(data:any): string {\r\n    var cache = [];\r\n\r\n    return JSON.stringify(data, function(key, value) {\r\n      if (typeof value === 'object' && value !== null) {\r\n        if (cache.indexOf(value) !== -1) {\r\n          // Circular reference found, discard key\r\n          return;\r\n        }\r\n\r\n        cache.push(value);\r\n      }\r\n\r\n      return value;\r\n    });\r\n  }\r\n}\r\n\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \n\nexport class Configuration implements IConfigurationSettings {\n  private _apiKey:string;\n  private _enabled:boolean = true;\n  private _serverUrl:string = 'https://collector.exceptionless.io';\n  private _plugins:IEventPlugin[] = [];\n\n  public environmentInfoCollector:IEnvironmentInfoCollector;\n  public errorParser:IErrorParser;\n  public lastReferenceIdManager:ILastReferenceIdManager = new InMemoryLastReferenceIdManager();\n  public log:ILog;\n  public moduleCollector:IModuleCollector;\n  public requestInfoCollector:IRequestInfoCollector;\n  public submissionBatchSize;\n  public submissionClient:ISubmissionClient;\n  public storage:IStorage<any>;\n  public queue:IEventQueue;\n  public defaultTags:string[] = [];\n  public defaultData:Object = {};\n\n  constructor(settings?:IConfigurationSettings) {\n    function inject(fn:any) {\n      return typeof fn === 'function' ? fn(this) : fn;\n    }\n\n    settings = Utils.merge(Configuration.defaults, settings);\n\n    this.apiKey = settings.apiKey;\n    this.serverUrl = settings.serverUrl;\n    this.environmentInfoCollector = inject(settings.environmentInfoCollector);\n    this.errorParser = inject(settings.errorParser);\n    this.lastReferenceIdManager = inject(settings.lastReferenceIdManager) || new InMemoryLastReferenceIdManager();\n    this.log = inject(settings.log) || new NullLog();\n    this.moduleCollector = inject(settings.moduleCollector);\n    this.requestInfoCollector = inject(settings.requestInfoCollector);\n    this.submissionBatchSize = inject(settings.submissionBatchSize) || 50;\n    this.submissionClient = inject(settings.submissionClient);\n    this.storage = inject(settings.storage) || new InMemoryStorage<any>();\n    this.queue = inject(settings.queue) || new DefaultEventQueue(this);\n\n    EventPluginManager.addDefaultPlugins(this);\n  }\n\n  public get apiKey(): string {\n    return this._apiKey;\n  }\n\n  public set apiKey(value:string) {\n    this._apiKey = value || null;\n  }\n\n  public get serverUrl(): string {\n    return this._serverUrl;\n  }\n\n  public set serverUrl(value:string) {\n    if (!!value && value.length > 0) {\n      this._serverUrl = value;\n    }\n  }\n\n  public get enabled(): boolean {\n    return this._enabled;\n  }\n\n  public get plugins(): IEventPlugin[] {\n    return this._plugins.sort((p1:IEventPlugin, p2:IEventPlugin) => {\n      return (p1.priority < p2.priority) ? -1 : (p1.priority > p2.priority) ? 1 : 0;\n    });\n  }\n\n  public addPlugin(plugin:IEventPlugin): void;\n  public addPlugin(name:string, priority:number, pluginAction:(context:EventPluginContext) => void): void;\n  public addPlugin(pluginOrName:IEventPlugin|string, priority?:number, pluginAction?:(context:EventPluginContext) => Promise<any>): void {\n    var plugin:IEventPlugin = !!pluginAction ? { name: <string>pluginOrName, priority: priority, run: pluginAction } : <IEventPlugin>pluginOrName;\n    if (!plugin || !plugin.run) {\n      this.log.error('Unable to add plugin: No run method was found.');\n      return;\n    }\n\n    if (!plugin.name) {\n      plugin.name = Utils.guid();\n    }\n\n    if (!plugin.priority) {\n      plugin.priority = 0;\n    }\n\n    var pluginExists:boolean = false;\n    for(var index = 0; index < this._plugins.length; index++) {\n      if (this._plugins[index].name === plugin.name) {\n        pluginExists = true;\n        break;\n      }\n    }\n\n    if (!pluginExists) {\n      this._plugins.push(plugin);\n    }\n  }\n\n  public removePlugin(plugin:IEventPlugin): void;\n  public removePlugin(name:string): void;\n  public removePlugin(pluginOrName:IEventPlugin|string): void {\n    var name:string = typeof pluginOrName === 'string' ? pluginOrName : pluginOrName.name;\n    if (!name) {\n      this.log.error('Unable to remove plugin: No plugin name was specified.');\n      return;\n    }\n\n    for(var index = 0; index < this._plugins.length; index++) {\n      if (this._plugins[index].name === name) {\n        this._plugins.splice(index, 1);\n        break;\n      }\n    }\n  }\n\n  public setVersion(version:string): void {\n    if (!!version && version.length > 0) {\n      this.defaultData['@version'] = version;\n    }\n  }\n\n  public setUserIdentity(userInfo:IUserInfo): void;\n  public setUserIdentity(identity:string): void;\n  public setUserIdentity(identity:string, name:string): void;\n  public setUserIdentity(userInfoOrIdentity:IUserInfo|string, name?:string): void {\n    var userInfo = typeof userInfoOrIdentity !== 'string' ? userInfoOrIdentity : { identity: userInfoOrIdentity, name: name };\n    if (!userInfo.identity && !userInfo.name) {\n      delete this.defaultData['@user'];\n    } else {\n      this.defaultData['@user'] = userInfo;\n    }\n  }\n\n  public useReferenceIds(): void {\n    this.addPlugin(new ReferenceIdPlugin());\n  }\n\n  // TODO: Support a min log level.\n  public useDebugLogger(): void {\n    this.log = new ConsoleLog();\n  }\n\n  private static _defaultSettings:IConfigurationSettings = null;\n  public static get defaults() {\n    if(Configuration._defaultSettings === null) {\n      Configuration._defaultSettings = {};\n    }\n\n    return Configuration._defaultSettings;\n  }\n}\n\n                                                                                                                                                                                                                                                                                                           \n\nexport class EventBuilder {\n  public target:IEvent;\n  public client:ExceptionlessClient;\n  public pluginContextData:ContextData;\n\n  constructor(event:IEvent, client:ExceptionlessClient, pluginContextData?:ContextData) {\n    this.target = event;\n    this.client = client;\n    this.pluginContextData = pluginContextData || new ContextData();\n  }\n\n  public setType(type:string): EventBuilder {\n    if (!!type && type.length > 0) {\n      this.target.type = type;\n    }\n\n    return this;\n  }\n\n  public setSource(source:string): EventBuilder {\n    if (!!source && source.length > 0) {\n      this.target.source = source;\n    }\n\n    return this;\n  }\n\n  public setSessionId(sessionId:string): EventBuilder {\n    if (!this.isValidIdentifier(sessionId)) {\n      throw new Error(\"SessionId must contain between 8 and 100 alphanumeric or '-' characters.\");\n    }\n\n    this.target.session_id = sessionId;\n    return this;\n  }\n\n  public setReferenceId(referenceId:string): EventBuilder {\n    if (!this.isValidIdentifier(referenceId)) {\n      throw new Error(\"SessionId must contain between 8 and 100 alphanumeric or '-' characters.\");\n    }\n\n    this.target.reference_id = referenceId;\n    return this;\n  }\n\n  public setMessage(message:string): EventBuilder {\n    if (!!message && message.length > 0) {\n      this.target.message = message;\n    }\n\n    return this;\n  }\n\n  public setGeo(latitude: number, longitude: number): EventBuilder {\n    if (latitude < -90.0 || latitude > 90.0)\n      throw new Error('Must be a valid latitude value between -90.0 and 90.0.');\n    if (longitude < -180.0 || longitude > 180.0)\n      throw new Error('Must be a valid longitude value between -180.0 and 180.0.');\n\n    this.target.geo = `${latitude},${longitude}`;\n    return this;\n  }\n\n  public setUserIdentity(userInfo:IUserInfo): EventBuilder;\n  public setUserIdentity(identity:string): EventBuilder;\n  public setUserIdentity(identity:string, name:string): EventBuilder;\n  public setUserIdentity(userInfoOrIdentity:IUserInfo|string, name?:string): EventBuilder {\n    var userInfo = typeof userInfoOrIdentity !== 'string' ? userInfoOrIdentity : { identity: userInfoOrIdentity, name: name };\n    if (!userInfo.identity && !userInfo.name) {\n      return this;\n    }\n\n    this.setProperty('@user', userInfo);\n    return this;\n  }\n\n  // TODO: we to see if it makes sense to add setUserDescription.\n\n  public setValue(value:number): EventBuilder {\n    if (!!value) {\n      this.target.value = value;\n    }\n\n    return this;\n  }\n\n  public addTags(...tags:string[]): EventBuilder {\n    if (!tags || tags.length === 0) {\n      return this;\n    }\n\n    if (!this.target.tags) {\n      this.target.tags = [];\n    }\n\n    for (var index = 0; index < tags.length; index++) {\n      if (tags[index] && this.target.tags.indexOf(tags[index]) < 0) {\n        this.target.tags.push(tags[index]);\n      }\n    }\n\n    return this;\n  }\n\n  public setProperty(name:string, value:any): EventBuilder {\n    if (!name || (value === undefined || value == null)) {\n      return this;\n    }\n\n    if (!this.target.data) {\n      this.target.data = {};\n    }\n\n    this.target.data[name] = value;\n    return this;\n  }\n\n  public markAsCritical(critical:boolean): EventBuilder {\n    if (critical) {\n      this.addTags('Critical');\n    }\n\n    return this;\n  }\n\n  public addRequestInfo(request:any) {\n    if (!!request) {\n      this.pluginContextData['@request'] = request;\n    }\n\n\n    return this;\n  }\n\n  public submit(): Promise<any> {\n    return this.client.submitEvent(this.target, this.pluginContextData);\n  }\n\n  private isValidIdentifier(value:string): boolean {\n    if (!value || !value.length) {\n      return true;\n    }\n\n    if (value.length < 8 || value.length > 100) {\n      return false;\n    }\n\n    for (var index = 0; index < value.length; index++) {\n      var code = value.charCodeAt(index);\n      var isDigit = (code >= 48) && (code <= 57);\n      var isLetter = ((code >= 65) && (code <= 90)) || ((code >= 97) && (code <= 122));\n      var isMinus = code === 45;\n\n      if (!(isDigit || isLetter) && !isMinus) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n}\n\n                                                                                  \r\n\r\nexport interface IError extends IInnerError {\r\n  modules?:IModule[]\r\n}\r\n\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \n\nexport class ExceptionlessClient {\n  public config:Configuration;\n\n  constructor();\n  constructor(settings:IConfigurationSettings);\n  constructor(apiKey:string, serverUrl?:string);\n  constructor(settingsOrApiKey?:IConfigurationSettings|string, serverUrl?:string) {\n    // TODO: populate this in a plugin..\n    //var settings = this.getSettingsFromScriptTag() || {};\n\n    if (typeof settingsOrApiKey !== 'object') {\n      this.config = new Configuration(settingsOrApiKey);\n    } else {\n      this.config = new Configuration({ apiKey: <string>settingsOrApiKey, serverUrl: serverUrl });\n    }\n  }\n\n  public createException(exception:Error): EventBuilder {\n    var pluginContextData = new ContextData();\n    pluginContextData.setException(exception);\n    return this.createEvent(pluginContextData).setType('error');\n  }\n\n  public submitException(exception:Error): Promise<any> {\n    return this.createException(exception).submit();\n  }\n\n  public createUnhandledException(exception:Error, submissionMethod?:string): EventBuilder {\n    var builder = this.createException(exception);\n    builder.pluginContextData.markAsUnhandledError();\n    builder.pluginContextData.setSubmissionMethod(submissionMethod);\n\n    return builder;\n  }\n\n  public submitUnhandledException(exception:Error, submissionMethod?:string): Promise<any> {\n    return this.createUnhandledException(exception, submissionMethod).submit();\n  }\n\n  public createFeatureUsage(feature:string): EventBuilder {\n    return this.createEvent().setType('usage').setSource(feature);\n  }\n\n  public submitFeatureUsage(feature:string): Promise<any> {\n    return this.createFeatureUsage(feature).submit();\n  }\n\n  public createLog(message:string): EventBuilder;\n  public createLog(source:string, message:string): EventBuilder;\n  public createLog(source:string, message:string, level:string): EventBuilder;\n  public createLog(sourceOrMessage:string, message?:string, level?:string): EventBuilder {\n    var builder = this.createEvent().setType('log');\n\n    if (sourceOrMessage && message && level) {\n      builder = builder.setSource(sourceOrMessage).setMessage(message).setProperty('@level', level);\n    } else if (sourceOrMessage && message) {\n      builder = builder.setSource(sourceOrMessage).setMessage(message);\n    } else {\n      // TODO: Look into using https://www.stevefenton.co.uk/Content/Blog/Date/201304/Blog/Obtaining-A-Class-Name-At-Runtime-In-TypeScript/\n      var source = (<any>(arguments.callee.caller)).name;\n      builder = builder.setSource(source).setMessage(sourceOrMessage);\n    }\n\n    return builder;\n  }\n\n  public submitLog(message:string): Promise<any>;\n  public submitLog(source:string, message:string): Promise<any>;\n  public submitLog(source:string, message:string, level:string): Promise<any>;\n  public submitLog(sourceOrMessage:string, message?:string, level?:string): Promise<any> {\n    return this.createLog(sourceOrMessage, message, level).submit();\n  }\n\n  public createNotFound(resource:string): EventBuilder {\n    return this.createEvent().setType('404').setSource(resource);\n  }\n\n  public submitNotFound(resource:string): Promise<any> {\n    return this.createNotFound(resource).submit();\n  }\n\n  public createSessionStart(sessionId:string): EventBuilder {\n    return this.createEvent().setType('start').setSessionId(sessionId);\n  }\n\n  public submitSessionStart(sessionId:string): Promise<any> {\n    return this.createSessionStart(sessionId).submit();\n  }\n\n  public createSessionEnd(sessionId:string): EventBuilder {\n    return this.createEvent().setType('end').setSessionId(sessionId);\n  }\n\n  public submitSessionEnd(sessionId:string): Promise<any> {\n    return this.createSessionEnd(sessionId).submit();\n  }\n\n  public createEvent(pluginContextData?:ContextData): EventBuilder {\n    return new EventBuilder({ date: new Date() }, this, pluginContextData);\n  }\n\n  public submitEvent(event:IEvent, pluginContextData?:ContextData): Promise<any> {\n    if (!event) {\n      return Promise.reject(new Error('Unable to submit undefined event.'));\n    }\n\n    if (!this.config.enabled) {\n      var message:string = 'Event submission is currently disabled.';\n      this.config.log.info(message);\n      return Promise.reject(new Error(message));\n    }\n\n    var context = new EventPluginContext(this, event, pluginContextData);\n    return EventPluginManager.run(context)\n      .then(() => {\n        if (context.cancel) {\n          var message:string = `Event submission cancelled by plugin\": id=${event.reference_id} type=${event.type}`;\n          this.config.log.info(message);\n          return Promise.reject(new Error(message));\n        }\n\n        // ensure all required data\n        if (!event.type || event.type.length === 0) {\n          event.type = 'log';\n        }\n\n        if (!event.date) {\n          event.date = new Date();\n        }\n\n        this.config.log.info(`Submitting event: type=${event.type} ${!!event.reference_id ? 'refid=' + event.reference_id : ''}`);\n        this.config.queue.enqueue(event);\n\n        if (event.reference_id && event.reference_id.length > 0) {\n          this.config.log.info(`Setting last reference id \"${event.reference_id}\"`);\n          this.config.lastReferenceIdManager.setLast(event.reference_id);\n        }\n\n        return Promise.resolve();\n      })\n      .catch((error:Error) => {\n        var message:string = `Event submission cancelled. An error occurred while running the plugins: ${error && error.message ? error.message : <any>error}`;\n        this.config.log.error(message);\n        return Promise.reject(new Error(message));\n      });\n  }\n\n  public getLastReferenceId(): string {\n    return this.config.lastReferenceIdManager.getLast();\n  }\n\n  private static _instance:ExceptionlessClient = null;\n  public static get default() {\n    if(ExceptionlessClient._instance === null) {\n      ExceptionlessClient._instance = new ExceptionlessClient(null);\n    }\n    return ExceptionlessClient._instance;\n  }\n}\n\nexport interface IParameter {\r\n  data?:any;\r\n  generic_arguments?:string[];\r\n\r\n  name?:string;\r\n  type?:string;\r\n  type_namespace?:string;\r\n}\r\n\n                                          \r\n\r\nexport interface IMethod {\r\n  data?:any;\r\n  generic_arguments?:string[];\r\n  parameters?:IParameter[];\r\n\r\n  is_signature_target?:boolean;\r\n  declaring_namespace?:string;\r\n  declaring_type?:string;\r\n  name?:string;\r\n  module_id?:number;\r\n}\r\n\n                                    \r\n\r\nexport interface IStackFrame extends IMethod {\r\n  file_name:string;\r\n  line_number:number;\r\n  column:number;\r\n}\r\n\n                                                                                  \r\n\r\nexport interface IInnerError {\r\n  message?:string;\r\n  type?:string;\r\n  code?:string;\r\n  data?:any;\r\n  inner?:IInnerError\r\n  stack_trace?:IStackFrame[];\r\n  target_method?:IMethod;\r\n}\r\n\nexport interface IModule {\r\n  data?:any;\r\n\r\n  module_id?:number;\r\n  name?:string;\r\n  version?:string;\r\n  is_entry?:boolean;\r\n  created_date?:Date;\r\n  modified_date?:Date;\r\n}\r\n\n                                                                                                            \r\n\r\nexport class ConfigurationDefaultsPlugin implements IEventPlugin {\r\n  public priority:number = 10;\r\n  public name:string = 'ConfigurationDefaultsPlugin';\r\n\r\n  run(context:EventPluginContext): Promise<any> {\r\n    if (!!context.client.config.defaultTags) {\r\n      if (!context.event.tags) {\r\n        context.event.tags = [];\r\n      }\r\n\r\n      for (var index = 0; index < context.client.config.defaultTags.length; index++) {\r\n        var tag = context.client.config.defaultTags[index];\r\n        if (tag && context.client.config.defaultTags.indexOf(tag) < 0) {\r\n          context.event.tags.push(tag)\r\n        }\r\n      }\r\n    }\r\n\r\n    if (!!context.client.config.defaultData) {\r\n      if (!context.event.data) {\r\n        context.event.data = {};\r\n      }\r\n\r\n      for (var key in context.client.config.defaultData) {\r\n        if (!!context.client.config.defaultData[key]) {\r\n          context.event.data[key] = context.client.config.defaultData[key];\r\n        }\r\n      }\r\n    }\r\n\r\n    return Promise.resolve();\r\n  }\r\n}\r\n\n                                                                                                           \n\nexport class ErrorPlugin implements IEventPlugin {\n  public priority:number = 30;\n  public name:string = 'ErrorPlugin';\n\n  run(context:EventPluginContext): Promise<any> {\n    var exception = context.contextData.getException();\n    if (exception == null) {\n      return Promise.resolve();\n    }\n\n    if (!context.event.data) {\n      context.event.data = {};\n    }\n\n    context.event.type = 'error';\n    if (!!context.event.data['@error']) {\n      return Promise.resolve();\n    }\n\n    var parser = context.client.config.errorParser;\n    if (!parser) {\n      context.cancel = true;\n      return Promise.reject(new Error('No error parser was defined. This exception will be discarded.'))\n    }\n\n    return parser.parse(context, exception);\n  }\n}\n\n                                                                                                            \r\n\r\nexport class DuplicateCheckerPlugin implements IEventPlugin {\r\n  public priority:number = 50;\r\n  public name:string = 'DuplicateCheckerPlugin';\r\n\r\n  run(context:EventPluginContext):Promise<any> {\r\n    // TODO: Implement\r\n    return Promise.resolve();\r\n  }\r\n}\r\n\n                                                                                                                                                                                                \n\nexport class ModuleInfoPlugin implements IEventPlugin {\n  public priority:number = 40;\n  public name:string = 'ModuleInfoPlugin';\n\n  run(context:EventPluginContext):Promise<any> {\n    if (!context.event.data ||\n        !context.event.data['@error'] ||\n        !!context.event.data['@error'].modules ||\n        !context.client.config.moduleCollector) {\n      return Promise.resolve();\n    }\n\n    var modules = context.client.config.moduleCollector.getModules(context);\n    if (modules && modules.length > 0) {\n      context.event.data['@error'].modules = modules;\n    }\n\n    return Promise.resolve();\n  }\n}\n\nexport interface IRequestInfo {\r\n  user_agent?:string;\r\n  http_method?:string;\r\n  is_secure?:boolean;\r\n  host?:string;\r\n  port?:number;\r\n  path?:string;\r\n  referrer?:string;\r\n  client_ip_address?:string;\r\n  cookies?:any;\r\n  post_data?:any;\r\n  query_string?:any;\r\n  data?:any\r\n}\r\n\n                                                                                                                                                                       \r\n\r\nexport class RequestInfoPlugin implements IEventPlugin {\r\n  public priority:number = 60;\r\n  public name:string = 'RequestInfoPlugin';\r\n\r\n  run(context:EventPluginContext):Promise<any> {\r\n    if (!!context.event.data && !!context.event.data['@request'] || !context.client.config.requestInfoCollector) {\r\n      return Promise.resolve();\r\n    }\r\n\r\n    if (!context.event.data) {\r\n      context.event.data = {};\r\n    }\r\n\r\n    var ri = context.client.config.requestInfoCollector.getRequestInfo(context);\r\n    if (ri) {\r\n      context.event.data['@request'] = ri;\r\n    }\r\n\r\n    return Promise.resolve();\r\n  }\r\n}\r\n\n                                                                                                                                                                               \r\n\r\nexport class EnvironmentInfoPlugin implements IEventPlugin {\r\n  public priority:number = 70;\r\n  public name:string = 'EnvironmentInfoPlugin';\r\n\r\n  run(context:EventPluginContext):Promise<any> {\r\n    if (!!context.event.data && !!context.event.data['@environment'] || !context.client.config.environmentInfoCollector) {\r\n      return Promise.resolve();\r\n    }\r\n\r\n    if (!context.event.data) {\r\n      context.event.data = {};\r\n    }\r\n\r\n    var ei = context.client.config.environmentInfoCollector.getEnvironmentInfo(context);\r\n    if (ei) {\r\n      context.event.data['@environment'] = ei;\r\n    }\r\n\r\n    return Promise.resolve();\r\n  }\r\n}\r\n\n                                                                                                            \r\n\r\nexport class SubmissionMethodPlugin implements IEventPlugin {\r\n  public priority:number = 100;\r\n  public name:string = 'SubmissionMethodPlugin';\r\n\r\n  run(context:EventPluginContext):Promise<any> {\r\n    var submissionMethod:string = context.contextData.getSubmissionMethod();\r\n    if (!!submissionMethod) {\r\n      if (!context.event.data) {\r\n        context.event.data = {};\r\n      }\r\n\r\n      context.event.data['@submission_method'] = submissionMethod;\r\n    }\r\n\r\n    return Promise.resolve();\r\n  }\r\n}\r\n\nexport interface IUserDescription {\r\n  email_address?:string;\r\n  description?:string;\r\n  data?:any;\r\n}\r\n\nexport class SettingsResponse {\r\n  success:boolean = false;\r\n  settings:any;\r\n  settingsVersion:number = -1;\r\n  message:string;\r\n  exception:any;\r\n\r\n  constructor(success:boolean, settings:any, settingsVersion:number = -1, exception:any = null, message:string = null) {\r\n    this.success = success;\r\n    this.settings = settings;\r\n    this.settingsVersion = settingsVersion;\r\n    this.exception = exception;\r\n    this.message = message;\r\n  }\r\n}\r\n\nexport class SubmissionResponse {\r\n  success:boolean = false;\r\n  badRequest:boolean = false;\r\n  serviceUnavailable:boolean = false;\r\n  paymentRequired:boolean = false;\r\n  unableToAuthenticate:boolean = false;\r\n  notFound:boolean = false;\r\n  requestEntityTooLarge:boolean = false;\r\n  statusCode:number;\r\n  message:string;\r\n\r\n  constructor(statusCode:number, message?:string) {\r\n    this.statusCode = statusCode;\r\n    this.message = message;\r\n\r\n    this.success = statusCode >= 200 && statusCode <= 299;\r\n    this.badRequest = statusCode === 400;\r\n    this.serviceUnavailable = statusCode === 503;\r\n    this.paymentRequired = statusCode === 402;\r\n    this.unableToAuthenticate = statusCode === 401 || statusCode === 403;\r\n    this.notFound = statusCode === 404;\r\n    this.requestEntityTooLarge = statusCode === 413;\r\n  }\r\n}\r\n\n                                                                                                                                                                                                             \r\n\r\nimport os = require('os');\r\n\r\nexport class NodeEnvironmentInfoCollector implements IEnvironmentInfoCollector {\r\n  public getEnvironmentInfo(context:EventPluginContext): IEnvironmentInfo {\r\n    if (!os) {\r\n      return null;\r\n    }\r\n\r\n    var environmentInfo: IEnvironmentInfo = {\r\n      processor_count: os.cpus().length,\r\n      total_physical_memory: os.totalmem(),\r\n      available_physical_memory: os.freemem(),\r\n      command_line: process.argv.join(' '),\r\n      process_name: process.title,\r\n      process_id: process.pid + '',\r\n      process_memory_size: process.memoryUsage().heapTotal,\r\n      //thread_id: '',\r\n      architecture: os.arch(),\r\n      o_s_name: os.type(),\r\n      o_s_version: os.release(),\r\n      ip_address: this.getIpAddresses(),\r\n      machine_name: os.hostname(),\r\n      //install_id: '',\r\n      runtime_version: process.version,\r\n      data: {\r\n        loadavg: os.loadavg(),\r\n        platform: os.platform(),\r\n        tmpdir: os.tmpdir(),\r\n        uptime: os.uptime()\r\n      }\r\n    };\r\n\r\n    if ((<any>os).endianness) {\r\n      environmentInfo.data.endianness = (<any>os).endianness();\r\n    }\r\n\r\n    return environmentInfo;\r\n  }\r\n\r\n  private getIpAddresses():string {\r\n    var ips = [];\r\n    var interfaces = os.networkInterfaces();\r\n    Object.keys(interfaces).forEach((name) => {\r\n      interfaces[name].forEach((iface:any) => {\r\n        if ('IPv4' === iface.family && !iface.internal) {\r\n          ips.push(iface.address);\r\n        }\r\n      });\r\n    });\r\n\r\n    return ips.join(', ');\r\n  }\r\n}\r\n\n                                                                                                                                                                                                                \n\nimport nodestacktrace = require('stack-trace');\n\nexport class NodeErrorParser implements IErrorParser {\n  public parse(context:EventPluginContext, exception:Error): Promise<IError> {\n    if (!nodestacktrace) {\n      context.cancel = true;\n      return Promise.reject(new Error('Unable to load the stack trace library. This exception will be discarded.'))\n    }\n\n    var stackFrames = nodestacktrace.parse(exception);\n    if (!stackFrames || stackFrames.length === 0) {\n      context.cancel = true;\n      return Promise.reject(new Error('Unable to parse the exceptions stack trace. This exception will be discarded.'))\n    }\n\n    var error:IError = {\n      message: exception.message,\n      stack_trace: this.getStackFrames(context, stackFrames || [])\n    };\n\n    context.event.data['@error'] = error;\n    return Promise.resolve();\n  }\n\n  private getStackFrames(context:EventPluginContext, stackFrames:any[]): IStackFrame[] {\n    var frames:IStackFrame[] = [];\n\n    for (var index = 0; index < stackFrames.length; index++) {\n      var frame = stackFrames[index];\n      frames.push({\n        name: frame.getMethodName() || frame.getFunctionName(),\n        //parameters: stackFrames[index].args,\n        file_name: frame.getFileName(),\n        line_number: frame.getLineNumber(),\n        column: frame.getColumnNumber(),\n        declaring_type: frame.getTypeName(),\n        data: {\n          is_native: frame.isNative() || (!!frame.filename && frame.filename[0] !== '/' && frame.filename[0] !== '.')\n        }\n      });\n    }\n\n    return frames;\n  }\n}\n\n                                                                                                                                                                                         \n\nexport class NodeRequestInfoCollector implements IRequestInfoCollector {\n  getRequestInfo(context:EventPluginContext):IRequestInfo {\n    if (!context.contextData['@request']) {\n      return null;\n    }\n\n    var request = context.contextData['@request'];\n    var ri:IRequestInfo = {\n      client_ip_address: request.ip,\n      user_agent: request.headers['user-agent'],\n      is_secure: request.secure,\n      http_method: request.method,\n      host: request.hostname || request.host,\n      //port: TODO,\n      path: request.path,\n      post_data: request.body,\n      //referrer: TODO,\n      cookies: this.getCookies(request),\n      query_string: request.params\n    };\n\n    return ri;\n  }\n\n  private getCookies(request): any {\n    if (!request) {\n      return null;\n    }\n\n    if (request.cookies) {\n      return request.cookies;\n    }\n\n    var result = {};\n    var cookies = (request.headers['cookie'] || '').split('; ');\n    for (var index = 0; index < cookies.length; index++) {\n      var cookie = cookies[index].split('=');\n      result[cookie[0]] = cookie[1];\n    }\n\n    return result;\n  }\n}\n\n                                                                                                                                                                                                                                                                                                                                                                                            \r\n\r\nimport http = require('http');\r\nimport https = require('https');\r\nimport url = require('url');\r\n\r\nexport class NodeSubmissionClient implements ISubmissionClient {\r\n  public submit(events:IEvent[], config:Configuration): Promise<SubmissionResponse> {\r\n    return this.sendRequest('POST', config.serverUrl, '/api/v2/events', config.apiKey, Utils.stringify(events)).then(\r\n      msg => { return new SubmissionResponse(msg.statusCode, this.getResponseMessage(msg)); },\r\n      msg => { return new SubmissionResponse(msg.statusCode || 500, this.getResponseMessage(msg)); }\r\n    );\r\n  }\r\n\r\n  public submitDescription(referenceId:string, description:IUserDescription, config:Configuration): Promise<SubmissionResponse> {\r\n    var path = `/api/v2/events/by-ref/${encodeURIComponent(referenceId)}/user-description`;\r\n    return this.sendRequest('POST', config.serverUrl, path, config.apiKey, Utils.stringify(description)).then(\r\n      msg => { return new SubmissionResponse(msg.statusCode, this.getResponseMessage(msg)); },\r\n      msg => { return new SubmissionResponse(msg.statusCode || 500, this.getResponseMessage(msg)); }\r\n    );\r\n  }\r\n\r\n  public getSettings(config:Configuration): Promise<SettingsResponse> {\r\n    return this.sendRequest('GET', config.serverUrl, '/api/v2/projects/config', config.apiKey).then(\r\n      msg => {\r\n        if (msg.statusCode !== 200 || !(<any>msg).responseText) {\r\n          return new SettingsResponse(false, null, -1, null, `Unable to retrieve configuration settings: ${this.getResponseMessage(msg)}`);\r\n        }\r\n\r\n        var settings;\r\n        try {\r\n          settings = JSON.parse((<any>msg).responseText);\r\n        } catch (e) {\r\n          config.log.error(`An error occurred while parsing the settings response text: \"${(<any>msg).responseText}\"`);\r\n        }\r\n\r\n        if (!settings || !settings.settings || !settings.version) {\r\n          return new SettingsResponse(true, null, -1, null, 'Invalid configuration settings.');\r\n        }\r\n\r\n        return new SettingsResponse(true, settings.settings, settings.version);\r\n      },\r\n      msg => {\r\n        return new SettingsResponse(false, null, -1, null, this.getResponseMessage(msg));\r\n      }\r\n    );\r\n  }\r\n\r\n  private getResponseMessage(msg:http.IncomingMessage): string {\r\n    if (!msg || (msg.statusCode >= 200 && msg.statusCode <= 299)) {\r\n      return null;\r\n    }\r\n\r\n    if (msg.statusCode === 0) {\r\n      return 'Unable to connect to server.';\r\n    }\r\n\r\n    return msg.statusMessage || (<any>msg).message;\r\n  }\r\n\r\n  private sendRequest(method:string, host:string, path:string, apiKey:string, data?:string): Promise<http.IncomingMessage> {\r\n    return new Promise((resolve, reject) => {\r\n      var parsedHost = url.parse(host);\r\n      var options:https.RequestOptions = {\r\n        auth: `client:${apiKey}`,\r\n        hostname: parsedHost.hostname,\r\n        method: method,\r\n        port: parsedHost.port && parseInt(parsedHost.port),\r\n        path: path\r\n      };\r\n\r\n      if (method === 'POST') {\r\n        options.headers = {\r\n          'Content-Type': 'application/json',\r\n          'Content-Length': data.length\r\n        }\r\n      }\r\n\r\n      var request:http.ClientRequest = https.request(options, (response:http.IncomingMessage) => {\r\n        var body = '';\r\n        response.on('data', chunk => body += chunk);\r\n        response.on('end', () => {\r\n          (<any>response).responseText = body;\r\n          resolve(response);\r\n        });\r\n      });\r\n\r\n      request.on('error', function(e) {\r\n        reject(e)\r\n      });\r\n\r\n      request.write(data);\r\n      request.end();\r\n    });\r\n  }\r\n}\r\n\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \r\n\r\nexport class NodeBootstrapper implements IBootstrapper {\r\n  public register(): void {\r\n    if (!this.isNode()) {\r\n      return;\r\n    }\r\n\r\n    Configuration.defaults.environmentInfoCollector = new NodeEnvironmentInfoCollector();\r\n    Configuration.defaults.errorParser = new NodeErrorParser();\r\n    Configuration.defaults.requestInfoCollector = new NodeRequestInfoCollector();\r\n    Configuration.defaults.submissionClient = new NodeSubmissionClient();\r\n    process.on('uncaughtException', function(error) {\r\n      ExceptionlessClient.default.submitUnhandledException(error, 'uncaughtException');\r\n    });\r\n\r\n    process.on('beforeExit', (code:number) => {\r\n      var client = ExceptionlessClient.default;\r\n\r\n      var message = this.getExitCodeReason(code);\r\n      if (message !== null) {\r\n        client.submitLog('beforeExit', message, 'Error')\r\n      }\r\n\r\n      client.config.queue.process()\r\n    });\r\n  }\r\n\r\n  // exit codes: https://nodejs.org/api/process.html#process_event_exit\r\n  private getExitCodeReason(code:number): string {\r\n    if (code === 1) {\r\n      return 'Uncaught Fatal Exception';\r\n    }\r\n\r\n    if (code === 3) {\r\n      return 'Internal JavaScript Parse Error';\r\n    }\r\n\r\n    if (code === 4) {\r\n      return 'Internal JavaScript Evaluation Failure';\r\n    }\r\n\r\n    if (code === 5) {\r\n      return 'Fatal Exception';\r\n    }\r\n\r\n    if (code === 6) {\r\n      return 'Non-function Internal Exception Handler ';\r\n    }\r\n\r\n    if (code === 7) {\r\n      return 'Internal Exception Handler Run-Time Failure';\r\n    }\r\n\r\n    if (code === 8) {\r\n      return 'Uncaught Exception';\r\n    }\r\n\r\n    if (code === 9) {\r\n      return 'Invalid Argument';\r\n    }\r\n\r\n    if (code === 10) {\r\n      return 'Internal JavaScript Run-Time Failure';\r\n    }\r\n\r\n    if (code === 12) {\r\n      return 'Invalid Debug Argument';\r\n    }\r\n\r\n    if (code > 128) {\r\n      return 'Signal Exits';\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  private isNode(): boolean {\r\n    return typeof window === 'undefined' && typeof global !== 'undefined' && {}.toString.call(global) === '[object global]';\r\n  }\r\n}\r\n\n                                                                                                                                                                                                                \n\nexport class WebErrorParser implements IErrorParser {\n  public parse(context:EventPluginContext, exception:Error): Promise<IError> {\n    return StackTrace.fromError(exception).then(\n      (stackFrames: StackTrace.StackFrame[]) => this.processError(context, exception, stackFrames),\n      () => this.onParseError(context)\n    );\n  }\n\n  private processError(context:EventPluginContext, exception:Error, stackFrames: StackTrace.StackFrame[]): Promise<any> {\n    var error:IError = {\n      message: exception.message,\n      stack_trace: this.getStackFrames(context, stackFrames || [])\n    };\n\n    context.event.data['@error'] = error;\n\n    return Promise.resolve();\n  }\n\n  private onParseError(context:EventPluginContext): Promise<any>  {\n    context.cancel = true;\n    return Promise.reject(new Error('Unable to parse the exceptions stack trace. This exception will be discarded.'))\n  }\n\n  private getStackFrames(context:EventPluginContext, stackFrames:StackTrace.StackFrame[]): IStackFrame[] {\n    var frames:IStackFrame[] = [];\n\n    for (var index = 0; index < stackFrames.length; index++) {\n      frames.push({\n        name: stackFrames[index].functionName,\n        parameters: stackFrames[index].args, // TODO: need to verify arguments.\n        file_name: stackFrames[index].fileName,\n        line_number: stackFrames[index].lineNumber,\n        column: stackFrames[index].columnNumber\n      });\n    }\n\n    return frames;\n  }\n}\n\n                                                                                                                                                                                                       \n\nexport class WebModuleCollector implements IModuleCollector {\n  public getModules(context:EventPluginContext): IModule[] {\n    if (document && document.getElementsByTagName) {\n      return null;\n    }\n\n    var modules:IModule[] = [];\n    var scripts = document.getElementsByTagName('script');\n    if (scripts && scripts.length > 0) {\n      for (var index = 0; index < scripts.length; index++) {\n        if (scripts[index].src) {\n          modules.push({\n            module_id: index,\n            name: scripts[index].src,\n            version: Utils.parseVersion(scripts[index].src)\n          });\n        } else if (!!scripts[index].innerHTML) {\n          modules.push({\n            module_id: index,\n            name: 'Script Tag',\n            version: Utils.getHashCode(scripts[index].innerHTML)\n          });\n        }\n      }\n    }\n\n    return modules;\n  }\n}\n\n                                                                                                                                                                                                                              \r\n\r\nexport class WebRequestInfoCollector implements IRequestInfoCollector {\r\n  public getRequestInfo(context:EventPluginContext): IRequestInfo {\r\n    if (!navigator || !location) {\r\n      return null;\r\n    }\r\n\r\n    var requestInfo:IRequestInfo = {\r\n      user_agent: navigator.userAgent,\r\n      is_secure: location.protocol === 'https:',\r\n      host: location.hostname,\r\n      port: location.port && location.port !== '' ? parseInt(location.port) : 80,\r\n      path: location.pathname,\r\n      //client_ip_address: 'TODO',\r\n      cookies: this.getCookies(),\r\n      query_string: Utils.parseQueryString(location.search.substring(1))\r\n    };\r\n\r\n    if (document.referrer && document.referrer !== '') {\r\n      requestInfo.referrer = document.referrer;\r\n    }\r\n  }\r\n\r\n  private getCookies(): any {\r\n    if (!document.cookie) {\r\n      return null;\r\n    }\r\n\r\n    var result = {};\r\n\r\n    var cookies = document.cookie.split(', ');\r\n    for (var index = 0; index < cookies.length; index++) {\r\n      var cookie = cookies[index].split('=');\r\n      result[cookie[0]] = cookie[1];\r\n    }\r\n\r\n    return result;\r\n  }\r\n}\r\n\n                                                                                                                                                                                                                                                                                                                                                                                      \n\ndeclare var XDomainRequest: { new (); create(); };\n\nexport class DefaultSubmissionClient implements ISubmissionClient {\n  public submit(events:IEvent[], config:Configuration): Promise<SubmissionResponse> {\n    var url = `${config.serverUrl}/api/v2/events?access_token=${encodeURIComponent(config.apiKey)}`;\n    return this.sendRequest('POST', url, Utils.stringify(events)).then(\n        xhr => { return new SubmissionResponse(xhr.status, this.getResponseMessage(xhr)); },\n        xhr => { return new SubmissionResponse(xhr.status || 500, this.getResponseMessage(xhr)); }\n    );\n  }\n\n  public submitDescription(referenceId:string, description:IUserDescription, config:Configuration): Promise<SubmissionResponse> {\n    var url = `${config.serverUrl}/api/v2/events/by-ref/${encodeURIComponent(referenceId)}/user-description?access_token=${encodeURIComponent(config.apiKey)}`;\n    return this.sendRequest('POST', url, Utils.stringify(description)).then(\n        xhr => { return new SubmissionResponse(xhr.status, this.getResponseMessage(xhr)); },\n        xhr => { return new SubmissionResponse(xhr.status || 500, this.getResponseMessage(xhr)); }\n    );\n  }\n\n  public getSettings(config:Configuration): Promise<SettingsResponse> {\n    var url = `${config.serverUrl}/api/v2/projects/config?access_token=${encodeURIComponent(config.apiKey)}`;\n    return this.sendRequest('GET', url).then(\n        xhr => {\n        if (xhr.status !== 200) {\n          return new SettingsResponse(false, null, -1, null, `Unable to retrieve configuration settings: ${this.getResponseMessage(xhr)}`);\n        }\n\n        var settings;\n        try {\n          settings = JSON.parse(xhr.responseText);\n        } catch (e) {\n          config.log.error(`An error occurred while parsing the settings response text: \"${xhr.responseText}\"`);\n        }\n\n        if (!settings || !settings.settings || !settings.version) {\n          return new SettingsResponse(true, null, -1, null, 'Invalid configuration settings.');\n        }\n\n        return new SettingsResponse(true, settings.settings, settings.version);\n      },\n        xhr => {\n        return new SettingsResponse(false, null, -1, null, this.getResponseMessage(xhr));\n      }\n    );\n  }\n\n  private getResponseMessage(xhr:XMLHttpRequest): string {\n    if (!xhr || (xhr.status >= 200 && xhr.status <= 299)) {\n      return null;\n    }\n\n    if (xhr.status === 0) {\n      return 'Unable to connect to server.';\n    }\n\n    if (xhr.responseBody) {\n      return xhr.responseBody.message;\n    }\n\n    if (xhr.responseText) {\n      try {\n        return JSON.parse(xhr.responseText).message;\n      } catch (e) {\n        return xhr.responseText;\n      }\n    }\n\n    return  xhr.statusText;\n  }\n\n  private createRequest(method:string, url:string): XMLHttpRequest {\n    var xhr:any = new XMLHttpRequest();\n    if ('withCredentials' in xhr) {\n      xhr.open(method, url, true);\n    } else if (typeof XDomainRequest != 'undefined') {\n      xhr = new XDomainRequest();\n      xhr.open(method, url);\n    } else {\n      xhr = null;\n    }\n\n    if (xhr) {\n      if (method === 'POST' && xhr.setRequestHeader) {\n        xhr.setRequestHeader('Content-Type', 'application/json');\n      }\n\n      xhr.timeout = 10000;\n    }\n\n    return xhr;\n  }\n\n  private sendRequest(method:string, url:string, data?:string): Promise<any> {\n    var xhr = this.createRequest(method || 'POST', url);\n\n    return new Promise((resolve, reject) => {\n      if (!xhr) {\n        return reject({ status: 503, message: 'CORS not supported.' });\n      }\n\n      if ('withCredentials' in xhr) {\n        xhr.onreadystatechange = () => {\n          // xhr not ready.\n          if (xhr.readyState !== 4) {\n            return;\n          }\n\n          if (xhr.status >= 200 && xhr.status <= 299) {\n            resolve(xhr);\n          } else {\n            reject(xhr);\n          }\n        };\n      }\n\n      xhr.ontimeout = () => reject(xhr);\n      xhr.onerror = () => reject(xhr);\n      xhr.onload = () => resolve(xhr);\n\n      xhr.send(data);\n    });\n  }\n}\n\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \n\nexport class WindowBootstrapper implements IBootstrapper {\n  public register(): void {\n    if (typeof window === 'undefined' || typeof document === 'undefined') {\n      return;\n    }\n\n    var settings = this.getDefaultsSettingsFromScriptTag();\n    if (settings && (settings.apiKey || settings.serverUrl)) {\n      Configuration.defaults.apiKey = settings.apiKey;\n      Configuration.defaults.serverUrl = settings.serverUrl;\n    }\n\n    Configuration.defaults.errorParser = new WebErrorParser();\n    Configuration.defaults.moduleCollector = new WebModuleCollector();\n    Configuration.defaults.requestInfoCollector = new WebRequestInfoCollector();\n    Configuration.defaults.submissionClient = new DefaultSubmissionClient();\n    this.handleWindowOnError();\n  }\n\n  private getDefaultsSettingsFromScriptTag(): IConfigurationSettings {\n    if (!document || !document.getElementsByTagName) {\n      return null;\n    }\n\n    var scripts = document.getElementsByTagName('script');\n    for (var index = 0; index < scripts.length; index++) {\n      if (scripts[index].src && scripts[index].src.indexOf('/exceptionless') > -1) {\n        return Utils.parseQueryString(scripts[index].src.split('?').pop());\n      }\n    }\n    return null;\n  }\n\n  private handleWindowOnError(): void {\n    var _oldOnErrorHandler:any = window.onerror;\n    (<any>window).onerror = (message:string, filename:string, lineno:number, colno:number, error:Error) => {\n      var client = ExceptionlessClient.default;\n\n      if (error !== null && typeof error === 'object') {\n        client.submitUnhandledException(error, 'onerror');\n      } else {\n        // Only message, filename and lineno work here.\n        var e:IError = {\n          message: message,\n          stack_trace: [{\n            file_name: filename,\n            line_number: lineno,\n            column: colno\n          }]\n        };\n\n        client.createUnhandledException(new Error(message), 'onerror').setMessage(message).setProperty('@error', e).submit();\n      }\n\n      if (_oldOnErrorHandler) {\n        try {\n          return _oldOnErrorHandler(message, filename, lineno, colno, error);\n        } catch (e) {\n          client.config.log.error(`An error occurred while calling previous error handler: ${e.message}`);\n        }\n      }\n\n      return false;\n    }\n  }\n}\n\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \n\nnew NodeBootstrapper().register();\nnew WindowBootstrapper().register();\n(<any>Error).stackTraceLimit = Infinity;\n\n"],"sourceRoot":"/source/"}